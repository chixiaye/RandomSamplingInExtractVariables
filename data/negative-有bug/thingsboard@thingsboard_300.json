{
  "id" : 300,
  "expression" : "savedAsset.getId()",
  "projectName" : "thingsboard@thingsboard",
  "commitID" : "7c2b3a9fbf84cc58aa7546029c5c7c10a662c55a",
  "filePath" : "/rule-engine/rule-engine-components/src/main/java/org/thingsboard/rule/engine/action/TbAbstractRelationActionNode.java",
  "occurrences" : 1,
  "isArithmeticExpression" : 0,
  "isGetTypeMethod" : 0,
  "expressionList" : [ {
    "nodeContext" : "savedAsset.getId()",
    "nodeType" : "MethodInvocation",
    "nodePosition" : {
      "charLength" : 18,
      "startLineNumber" : 215,
      "startColumnNumber" : 49,
      "endLineNumber" : 215,
      "endColumnNumber" : 67
    },
    "astNodeNumber" : 3,
    "astHeight" : 2,
    "parentDataList" : [ {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
      "nodePosition" : {
        "charLength" : 44,
        "startLineNumber" : 215,
        "startColumnNumber" : 24,
        "endLineNumber" : 215,
        "endColumnNumber" : 68
      },
      "nodeContext" : "targetEntity.setEntityId(savedAsset.getId())",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 6,
      "astHeight" : 3
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 45,
        "startLineNumber" : 215,
        "startColumnNumber" : 24,
        "endLineNumber" : 215,
        "endColumnNumber" : 69
      },
      "nodeContext" : "targetEntity.setEntityId(savedAsset.getId());\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 7,
      "astHeight" : 4
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
      "nodePosition" : {
        "charLength" : 727,
        "startLineNumber" : 206,
        "startColumnNumber" : 50,
        "endLineNumber" : 216,
        "endColumnNumber" : 21
      },
      "nodeContext" : "{\n  Asset newAsset=new Asset();\n  newAsset.setName(entitykey.getEntityName());\n  newAsset.setType(entitykey.getType());\n  newAsset.setTenantId(ctx.getTenantId());\n  Asset savedAsset=assetService.saveAsset(newAsset);\n  ctx.enqueue(ctx.assetCreatedMsg(savedAsset,ctx.getSelfId()),() -> log.trace(\"Pushed Asset Created message: {}\",savedAsset),throwable -> log.warn(\"Failed to push Asset Created message: {}\",savedAsset,throwable));\n  targetEntity.setEntityId(savedAsset.getId());\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 72,
      "astHeight" : 6
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,elseStatement]",
      "nodePosition" : {
        "charLength" : 750,
        "startLineNumber" : 206,
        "startColumnNumber" : 27,
        "endLineNumber" : 216,
        "endColumnNumber" : 21
      },
      "nodeContext" : "if (createIfNotExists) {\n  Asset newAsset=new Asset();\n  newAsset.setName(entitykey.getEntityName());\n  newAsset.setType(entitykey.getType());\n  newAsset.setTenantId(ctx.getTenantId());\n  Asset savedAsset=assetService.saveAsset(newAsset);\n  ctx.enqueue(ctx.assetCreatedMsg(savedAsset,ctx.getSelfId()),() -> log.trace(\"Pushed Asset Created message: {}\",savedAsset),throwable -> log.warn(\"Failed to push Asset Created message: {}\",savedAsset,throwable));\n  targetEntity.setEntityId(savedAsset.getId());\n}\n",
      "nodeType" : "IfStatement",
      "astNodeNumber" : 74,
      "astHeight" : 7
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.SwitchStatement,statements]",
      "nodePosition" : {
        "charLength" : 863,
        "startLineNumber" : 204,
        "startColumnNumber" : 20,
        "endLineNumber" : 216,
        "endColumnNumber" : 21
      },
      "nodeContext" : "if (asset != null) {\n  targetEntity.setEntityId(asset.getId());\n}\n else if (createIfNotExists) {\n  Asset newAsset=new Asset();\n  newAsset.setName(entitykey.getEntityName());\n  newAsset.setType(entitykey.getType());\n  newAsset.setTenantId(ctx.getTenantId());\n  Asset savedAsset=assetService.saveAsset(newAsset);\n  ctx.enqueue(ctx.assetCreatedMsg(savedAsset,ctx.getSelfId()),() -> log.trace(\"Pushed Asset Created message: {}\",savedAsset),throwable -> log.warn(\"Failed to push Asset Created message: {}\",savedAsset,throwable));\n  targetEntity.setEntityId(savedAsset.getId());\n}\n",
      "nodeType" : "IfStatement",
      "astNodeNumber" : 86,
      "astHeight" : 8
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 5565,
        "startLineNumber" : 182,
        "startColumnNumber" : 12,
        "endLineNumber" : 269,
        "endColumnNumber" : 13
      },
      "nodeContext" : "switch (type) {\ncase DEVICE:  DeviceService deviceService=ctx.getDeviceService();\nDevice device=deviceService.findDeviceByTenantIdAndName(ctx.getTenantId(),entitykey.getEntityName());\nif (device != null) {\ntargetEntity.setEntityId(device.getId());\n}\n else if (createIfNotExists) {\nDevice newDevice=new Device();\nnewDevice.setName(entitykey.getEntityName());\nnewDevice.setType(entitykey.getType());\nnewDevice.setTenantId(ctx.getTenantId());\nDevice savedDevice=deviceService.saveDevice(newDevice);\nctx.getClusterService().onDeviceUpdated(savedDevice,null);\nctx.enqueue(ctx.deviceCreatedMsg(savedDevice,ctx.getSelfId()),() -> log.trace(\"Pushed Device Created message: {}\",savedDevice),throwable -> log.warn(\"Failed to push Device Created message: {}\",savedDevice,throwable));\ntargetEntity.setEntityId(savedDevice.getId());\n}\nbreak;\ncase ASSET:AssetService assetService=ctx.getAssetService();\nAsset asset=assetService.findAssetByTenantIdAndName(ctx.getTenantId(),entitykey.getEntityName());\nif (asset != null) {\ntargetEntity.setEntityId(asset.getId());\n}\n else if (createIfNotExists) {\nAsset newAsset=new Asset();\nnewAsset.setName(entitykey.getEntityName());\nnewAsset.setType(entitykey.getType());\nnewAsset.setTenantId(ctx.getTenantId());\nAsset savedAsset=assetService.saveAsset(newAsset);\nctx.enqueue(ctx.assetCreatedMsg(savedAsset,ctx.getSelfId()),() -> log.trace(\"Pushed Asset Created message: {}\",savedAsset),throwable -> log.warn(\"Failed to push Asset Created message: {}\",savedAsset,throwable));\ntargetEntity.setEntityId(savedAsset.getId());\n}\nbreak;\ncase CUSTOMER:CustomerService customerService=ctx.getCustomerService();\nOptional<Customer> customerOptional=customerService.findCustomerByTenantIdAndTitle(ctx.getTenantId(),entitykey.getEntityName());\nif (customerOptional.isPresent()) {\ntargetEntity.setEntityId(customerOptional.get().getId());\n}\n else if (createIfNotExists) {\nCustomer newCustomer=new Customer();\nnewCustomer.setTitle(entitykey.getEntityName());\nnewCustomer.setTenantId(ctx.getTenantId());\nCustomer savedCustomer=customerService.saveCustomer(newCustomer);\nctx.enqueue(ctx.customerCreatedMsg(savedCustomer,ctx.getSelfId()),() -> log.trace(\"Pushed Customer Created message: {}\",savedCustomer),throwable -> log.warn(\"Failed to push Customer Created message: {}\",savedCustomer,throwable));\ntargetEntity.setEntityId(savedCustomer.getId());\n}\nbreak;\ncase TENANT:targetEntity.setEntityId(ctx.getTenantId());\nbreak;\ncase ENTITY_VIEW:EntityViewService entityViewService=ctx.getEntityViewService();\nEntityView entityView=entityViewService.findEntityViewByTenantIdAndName(ctx.getTenantId(),entitykey.getEntityName());\nif (entityView != null) {\ntargetEntity.setEntityId(entityView.getId());\n}\nbreak;\ncase EDGE:EdgeService edgeService=ctx.getEdgeService();\nEdge edge=edgeService.findEdgeByTenantIdAndName(ctx.getTenantId(),entitykey.getEntityName());\nif (edge != null) {\ntargetEntity.setEntityId(edge.getId());\n}\nbreak;\ncase DASHBOARD:DashboardService dashboardService=ctx.getDashboardService();\nPageData<DashboardInfo> dashboardInfoTextPageData=dashboardService.findDashboardsByTenantId(ctx.getTenantId(),new PageLink(200,0,entitykey.getEntityName()));\nfor (DashboardInfo dashboardInfo : dashboardInfoTextPageData.getData()) {\nif (dashboardInfo.getTitle().equals(entitykey.getEntityName())) {\ntargetEntity.setEntityId(dashboardInfo.getId());\n}\n}\nbreak;\ncase USER:UserService userService=ctx.getUserService();\nUser user=userService.findUserByEmail(ctx.getTenantId(),entitykey.getEntityName());\nif (user != null) {\ntargetEntity.setEntityId(user.getId());\n}\nbreak;\ndefault:return targetEntity;\n}\n",
      "nodeType" : "SwitchStatement",
      "astNodeNumber" : 524,
      "astHeight" : 9
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
      "nodePosition" : {
        "charLength" : 5791,
        "startLineNumber" : 178,
        "startColumnNumber" : 64,
        "endLineNumber" : 271,
        "endColumnNumber" : 9
      },
      "nodeContext" : "{\n  EntityType type=entitykey.getEntityType();\n  EntityContainer targetEntity=new EntityContainer();\n  targetEntity.setEntityType(type);\nswitch (type) {\ncase DEVICE:    DeviceService deviceService=ctx.getDeviceService();\n  Device device=deviceService.findDeviceByTenantIdAndName(ctx.getTenantId(),entitykey.getEntityName());\nif (device != null) {\n  targetEntity.setEntityId(device.getId());\n}\n else if (createIfNotExists) {\n  Device newDevice=new Device();\n  newDevice.setName(entitykey.getEntityName());\n  newDevice.setType(entitykey.getType());\n  newDevice.setTenantId(ctx.getTenantId());\n  Device savedDevice=deviceService.saveDevice(newDevice);\n  ctx.getClusterService().onDeviceUpdated(savedDevice,null);\n  ctx.enqueue(ctx.deviceCreatedMsg(savedDevice,ctx.getSelfId()),() -> log.trace(\"Pushed Device Created message: {}\",savedDevice),throwable -> log.warn(\"Failed to push Device Created message: {}\",savedDevice,throwable));\n  targetEntity.setEntityId(savedDevice.getId());\n}\nbreak;\ncase ASSET:AssetService assetService=ctx.getAssetService();\nAsset asset=assetService.findAssetByTenantIdAndName(ctx.getTenantId(),entitykey.getEntityName());\nif (asset != null) {\ntargetEntity.setEntityId(asset.getId());\n}\n else if (createIfNotExists) {\nAsset newAsset=new Asset();\nnewAsset.setName(entitykey.getEntityName());\nnewAsset.setType(entitykey.getType());\nnewAsset.setTenantId(ctx.getTenantId());\nAsset savedAsset=assetService.saveAsset(newAsset);\nctx.enqueue(ctx.assetCreatedMsg(savedAsset,ctx.getSelfId()),() -> log.trace(\"Pushed Asset Created message: {}\",savedAsset),throwable -> log.warn(\"Failed to push Asset Created message: {}\",savedAsset,throwable));\ntargetEntity.setEntityId(savedAsset.getId());\n}\nbreak;\ncase CUSTOMER:CustomerService customerService=ctx.getCustomerService();\nOptional<Customer> customerOptional=customerService.findCustomerByTenantIdAndTitle(ctx.getTenantId(),entitykey.getEntityName());\nif (customerOptional.isPresent()) {\ntargetEntity.setEntityId(customerOptional.get().getId());\n}\n else if (createIfNotExists) {\nCustomer newCustomer=new Customer();\nnewCustomer.setTitle(entitykey.getEntityName());\nnewCustomer.setTenantId(ctx.getTenantId());\nCustomer savedCustomer=customerService.saveCustomer(newCustomer);\nctx.enqueue(ctx.customerCreatedMsg(savedCustomer,ctx.getSelfId()),() -> log.trace(\"Pushed Customer Created message: {}\",savedCustomer),throwable -> log.warn(\"Failed to push Customer Created message: {}\",savedCustomer,throwable));\ntargetEntity.setEntityId(savedCustomer.getId());\n}\nbreak;\ncase TENANT:targetEntity.setEntityId(ctx.getTenantId());\nbreak;\ncase ENTITY_VIEW:EntityViewService entityViewService=ctx.getEntityViewService();\nEntityView entityView=entityViewService.findEntityViewByTenantIdAndName(ctx.getTenantId(),entitykey.getEntityName());\nif (entityView != null) {\ntargetEntity.setEntityId(entityView.getId());\n}\nbreak;\ncase EDGE:EdgeService edgeService=ctx.getEdgeService();\nEdge edge=edgeService.findEdgeByTenantIdAndName(ctx.getTenantId(),entitykey.getEntityName());\nif (edge != null) {\ntargetEntity.setEntityId(edge.getId());\n}\nbreak;\ncase DASHBOARD:DashboardService dashboardService=ctx.getDashboardService();\nPageData<DashboardInfo> dashboardInfoTextPageData=dashboardService.findDashboardsByTenantId(ctx.getTenantId(),new PageLink(200,0,entitykey.getEntityName()));\nfor (DashboardInfo dashboardInfo : dashboardInfoTextPageData.getData()) {\nif (dashboardInfo.getTitle().equals(entitykey.getEntityName())) {\ntargetEntity.setEntityId(dashboardInfo.getId());\n}\n}\nbreak;\ncase USER:UserService userService=ctx.getUserService();\nUser user=userService.findUserByEmail(ctx.getTenantId(),entitykey.getEntityName());\nif (user != null) {\ntargetEntity.setEntityId(user.getId());\n}\nbreak;\ndefault:return targetEntity;\n}\nreturn targetEntity;\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 548,
      "astHeight" : 10
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
      "nodePosition" : {
        "charLength" : 5847,
        "startLineNumber" : 178,
        "startColumnNumber" : 8,
        "endLineNumber" : 271,
        "endColumnNumber" : 9
      },
      "nodeContext" : "private EntityContainer loadEntity(EntityKey entitykey){\n  EntityType type=entitykey.getEntityType();\n  EntityContainer targetEntity=new EntityContainer();\n  targetEntity.setEntityType(type);\nswitch (type) {\ncase DEVICE:    DeviceService deviceService=ctx.getDeviceService();\n  Device device=deviceService.findDeviceByTenantIdAndName(ctx.getTenantId(),entitykey.getEntityName());\nif (device != null) {\n  targetEntity.setEntityId(device.getId());\n}\n else if (createIfNotExists) {\n  Device newDevice=new Device();\n  newDevice.setName(entitykey.getEntityName());\n  newDevice.setType(entitykey.getType());\n  newDevice.setTenantId(ctx.getTenantId());\n  Device savedDevice=deviceService.saveDevice(newDevice);\n  ctx.getClusterService().onDeviceUpdated(savedDevice,null);\n  ctx.enqueue(ctx.deviceCreatedMsg(savedDevice,ctx.getSelfId()),() -> log.trace(\"Pushed Device Created message: {}\",savedDevice),throwable -> log.warn(\"Failed to push Device Created message: {}\",savedDevice,throwable));\n  targetEntity.setEntityId(savedDevice.getId());\n}\nbreak;\ncase ASSET:AssetService assetService=ctx.getAssetService();\nAsset asset=assetService.findAssetByTenantIdAndName(ctx.getTenantId(),entitykey.getEntityName());\nif (asset != null) {\ntargetEntity.setEntityId(asset.getId());\n}\n else if (createIfNotExists) {\nAsset newAsset=new Asset();\nnewAsset.setName(entitykey.getEntityName());\nnewAsset.setType(entitykey.getType());\nnewAsset.setTenantId(ctx.getTenantId());\nAsset savedAsset=assetService.saveAsset(newAsset);\nctx.enqueue(ctx.assetCreatedMsg(savedAsset,ctx.getSelfId()),() -> log.trace(\"Pushed Asset Created message: {}\",savedAsset),throwable -> log.warn(\"Failed to push Asset Created message: {}\",savedAsset,throwable));\ntargetEntity.setEntityId(savedAsset.getId());\n}\nbreak;\ncase CUSTOMER:CustomerService customerService=ctx.getCustomerService();\nOptional<Customer> customerOptional=customerService.findCustomerByTenantIdAndTitle(ctx.getTenantId(),entitykey.getEntityName());\nif (customerOptional.isPresent()) {\ntargetEntity.setEntityId(customerOptional.get().getId());\n}\n else if (createIfNotExists) {\nCustomer newCustomer=new Customer();\nnewCustomer.setTitle(entitykey.getEntityName());\nnewCustomer.setTenantId(ctx.getTenantId());\nCustomer savedCustomer=customerService.saveCustomer(newCustomer);\nctx.enqueue(ctx.customerCreatedMsg(savedCustomer,ctx.getSelfId()),() -> log.trace(\"Pushed Customer Created message: {}\",savedCustomer),throwable -> log.warn(\"Failed to push Customer Created message: {}\",savedCustomer,throwable));\ntargetEntity.setEntityId(savedCustomer.getId());\n}\nbreak;\ncase TENANT:targetEntity.setEntityId(ctx.getTenantId());\nbreak;\ncase ENTITY_VIEW:EntityViewService entityViewService=ctx.getEntityViewService();\nEntityView entityView=entityViewService.findEntityViewByTenantIdAndName(ctx.getTenantId(),entitykey.getEntityName());\nif (entityView != null) {\ntargetEntity.setEntityId(entityView.getId());\n}\nbreak;\ncase EDGE:EdgeService edgeService=ctx.getEdgeService();\nEdge edge=edgeService.findEdgeByTenantIdAndName(ctx.getTenantId(),entitykey.getEntityName());\nif (edge != null) {\ntargetEntity.setEntityId(edge.getId());\n}\nbreak;\ncase DASHBOARD:DashboardService dashboardService=ctx.getDashboardService();\nPageData<DashboardInfo> dashboardInfoTextPageData=dashboardService.findDashboardsByTenantId(ctx.getTenantId(),new PageLink(200,0,entitykey.getEntityName()));\nfor (DashboardInfo dashboardInfo : dashboardInfoTextPageData.getData()) {\nif (dashboardInfo.getTitle().equals(entitykey.getEntityName())) {\ntargetEntity.setEntityId(dashboardInfo.getId());\n}\n}\nbreak;\ncase USER:UserService userService=ctx.getUserService();\nUser user=userService.findUserByEmail(ctx.getTenantId(),entitykey.getEntityName());\nif (user != null) {\ntargetEntity.setEntityId(user.getId());\n}\nbreak;\ndefault:return targetEntity;\n}\nreturn targetEntity;\n}\n",
      "nodeType" : "MethodDeclaration",
      "astNodeNumber" : 557,
      "astHeight" : 11
    } ],
    "currentLineData" : {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 45,
        "startLineNumber" : 215,
        "startColumnNumber" : 24,
        "endLineNumber" : 215,
        "endColumnNumber" : 69
      },
      "nodeContext" : "targetEntity.setEntityId(savedAsset.getId());\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 7,
      "astHeight" : 4
    },
    "tokenLength" : 2,
    "type" : "org.thingsboard.server.common.data.id.AssetId"
  } ],
  "positionList" : [ {
    "charLength" : 18,
    "startLineNumber" : 215,
    "startColumnNumber" : 49,
    "endLineNumber" : 215,
    "endColumnNumber" : 67
  } ],
  "layoutRelationDataList" : [ ]
}