{
  "id" : 81,
  "expression" : "!isNullOrEmpty(tlsServerKeyPath)",
  "projectName" : "apache@rocketmq",
  "commitID" : "7692d466e1fda6c29d52a61617cab1d82de8b884",
  "filePath" : "/remoting/src/main/java/org/apache/rocketmq/remoting/netty/TlsHelper.java",
  "occurrences" : 1,
  "isArithmeticExpression" : 0,
  "isGetTypeMethod" : 0,
  "expressionList" : [ {
    "nodeContext" : "!isNullOrEmpty(tlsServerKeyPath)",
    "nodeType" : "PrefixExpression",
    "nodePosition" : {
      "charLength" : 32,
      "startLineNumber" : 142,
      "startColumnNumber" : 20,
      "endLineNumber" : 142,
      "endColumnNumber" : 52
    },
    "astNodeNumber" : 4,
    "astHeight" : 3,
    "parentDataList" : [ {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
      "nodePosition" : {
        "charLength" : 103,
        "startLineNumber" : 142,
        "startColumnNumber" : 20,
        "endLineNumber" : 142,
        "endColumnNumber" : 123
      },
      "nodeContext" : "!isNullOrEmpty(tlsServerKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsServerKeyPath,false) : null",
      "nodeType" : "ConditionalExpression",
      "astNodeNumber" : 11,
      "astHeight" : 4
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodInvocation,expression]",
      "nodePosition" : {
        "charLength" : 344,
        "startLineNumber" : 140,
        "startColumnNumber" : 54,
        "endLineNumber" : 143,
        "endColumnNumber" : 87
      },
      "nodeContext" : "SslContextBuilder.forServer(!isNullOrEmpty(tlsServerCertPath) ? new FileInputStream(tlsServerCertPath) : null,!isNullOrEmpty(tlsServerKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsServerKeyPath,false) : null,!isNullOrEmpty(tlsServerKeyPassword) ? tlsServerKeyPassword : null)",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 31,
      "astHeight" : 5
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
      "nodePosition" : {
        "charLength" : 387,
        "startLineNumber" : 140,
        "startColumnNumber" : 54,
        "endLineNumber" : 144,
        "endColumnNumber" : 42
      },
      "nodeContext" : "SslContextBuilder.forServer(!isNullOrEmpty(tlsServerCertPath) ? new FileInputStream(tlsServerCertPath) : null,!isNullOrEmpty(tlsServerKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsServerKeyPath,false) : null,!isNullOrEmpty(tlsServerKeyPassword) ? tlsServerKeyPassword : null).sslProvider(provider)",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 34,
      "astHeight" : 6
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
      "nodePosition" : {
        "charLength" : 407,
        "startLineNumber" : 140,
        "startColumnNumber" : 34,
        "endLineNumber" : 144,
        "endColumnNumber" : 42
      },
      "nodeContext" : "sslContextBuilder=SslContextBuilder.forServer(!isNullOrEmpty(tlsServerCertPath) ? new FileInputStream(tlsServerCertPath) : null,!isNullOrEmpty(tlsServerKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsServerKeyPath,false) : null,!isNullOrEmpty(tlsServerKeyPassword) ? tlsServerKeyPassword : null).sslProvider(provider)",
      "nodeType" : "VariableDeclarationFragment",
      "astNodeNumber" : 36,
      "astHeight" : 7
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 426,
        "startLineNumber" : 140,
        "startColumnNumber" : 16,
        "endLineNumber" : 144,
        "endColumnNumber" : 43
      },
      "nodeContext" : "SslContextBuilder sslContextBuilder=SslContextBuilder.forServer(!isNullOrEmpty(tlsServerCertPath) ? new FileInputStream(tlsServerCertPath) : null,!isNullOrEmpty(tlsServerKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsServerKeyPath,false) : null,!isNullOrEmpty(tlsServerKeyPassword) ? tlsServerKeyPassword : null).sslProvider(provider);\n",
      "nodeType" : "VariableDeclarationStatement",
      "astNodeNumber" : 39,
      "astHeight" : 8
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,elseStatement]",
      "nodePosition" : {
        "charLength" : 957,
        "startLineNumber" : 139,
        "startColumnNumber" : 19,
        "endLineNumber" : 156,
        "endColumnNumber" : 13
      },
      "nodeContext" : "{\n  SslContextBuilder sslContextBuilder=SslContextBuilder.forServer(!isNullOrEmpty(tlsServerCertPath) ? new FileInputStream(tlsServerCertPath) : null,!isNullOrEmpty(tlsServerKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsServerKeyPath,false) : null,!isNullOrEmpty(tlsServerKeyPassword) ? tlsServerKeyPassword : null).sslProvider(provider);\n  if (!tlsServerAuthClient) {\n    sslContextBuilder.trustManager(InsecureTrustManagerFactory.INSTANCE);\n  }\n else {\n    if (!isNullOrEmpty(tlsServerTrustCertPath)) {\n      sslContextBuilder.trustManager(new File(tlsServerTrustCertPath));\n    }\n  }\n  sslContextBuilder.clientAuth(parseClientAuthMode(tlsServerNeedClientAuth));\n  return sslContextBuilder.build();\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 77,
      "astHeight" : 10
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 1370,
        "startLineNumber" : 132,
        "startColumnNumber" : 12,
        "endLineNumber" : 156,
        "endColumnNumber" : 13
      },
      "nodeContext" : "if (tlsTestModeEnable) {\n  SelfSignedCertificate selfSignedCertificate=new SelfSignedCertificate();\n  return SslContextBuilder.forServer(selfSignedCertificate.certificate(),selfSignedCertificate.privateKey()).sslProvider(SslProvider.JDK).clientAuth(ClientAuth.OPTIONAL).build();\n}\n else {\n  SslContextBuilder sslContextBuilder=SslContextBuilder.forServer(!isNullOrEmpty(tlsServerCertPath) ? new FileInputStream(tlsServerCertPath) : null,!isNullOrEmpty(tlsServerKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsServerKeyPath,false) : null,!isNullOrEmpty(tlsServerKeyPassword) ? tlsServerKeyPassword : null).sslProvider(provider);\n  if (!tlsServerAuthClient) {\n    sslContextBuilder.trustManager(InsecureTrustManagerFactory.INSTANCE);\n  }\n else {\n    if (!isNullOrEmpty(tlsServerTrustCertPath)) {\n      sslContextBuilder.trustManager(new File(tlsServerTrustCertPath));\n    }\n  }\n  sslContextBuilder.clientAuth(parseClientAuthMode(tlsServerNeedClientAuth));\n  return sslContextBuilder.build();\n}\n",
      "nodeType" : "IfStatement",
      "astNodeNumber" : 110,
      "astHeight" : 11
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,elseStatement]",
      "nodePosition" : {
        "charLength" : 1395,
        "startLineNumber" : 130,
        "startColumnNumber" : 15,
        "endLineNumber" : 157,
        "endColumnNumber" : 9
      },
      "nodeContext" : "{\n  if (tlsTestModeEnable) {\n    SelfSignedCertificate selfSignedCertificate=new SelfSignedCertificate();\n    return SslContextBuilder.forServer(selfSignedCertificate.certificate(),selfSignedCertificate.privateKey()).sslProvider(SslProvider.JDK).clientAuth(ClientAuth.OPTIONAL).build();\n  }\n else {\n    SslContextBuilder sslContextBuilder=SslContextBuilder.forServer(!isNullOrEmpty(tlsServerCertPath) ? new FileInputStream(tlsServerCertPath) : null,!isNullOrEmpty(tlsServerKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsServerKeyPath,false) : null,!isNullOrEmpty(tlsServerKeyPassword) ? tlsServerKeyPassword : null).sslProvider(provider);\n    if (!tlsServerAuthClient) {\n      sslContextBuilder.trustManager(InsecureTrustManagerFactory.INSTANCE);\n    }\n else {\n      if (!isNullOrEmpty(tlsServerTrustCertPath)) {\n        sslContextBuilder.trustManager(new File(tlsServerTrustCertPath));\n      }\n    }\n    sslContextBuilder.clientAuth(parseClientAuthMode(tlsServerNeedClientAuth));\n    return sslContextBuilder.build();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 111,
      "astHeight" : 12
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 2595,
        "startLineNumber" : 105,
        "startColumnNumber" : 8,
        "endLineNumber" : 157,
        "endColumnNumber" : 9
      },
      "nodeContext" : "if (forClient) {\n  if (tlsTestModeEnable) {\n    return SslContextBuilder.forClient().sslProvider(SslProvider.JDK).trustManager(InsecureTrustManagerFactory.INSTANCE).build();\n  }\n else {\n    SslContextBuilder sslContextBuilder=SslContextBuilder.forClient().sslProvider(SslProvider.JDK);\n    if (!tlsClientAuthServer) {\n      sslContextBuilder.trustManager(InsecureTrustManagerFactory.INSTANCE);\n    }\n else {\n      if (!isNullOrEmpty(tlsClientTrustCertPath)) {\n        sslContextBuilder.trustManager(new File(tlsClientTrustCertPath));\n      }\n    }\n    return sslContextBuilder.keyManager(!isNullOrEmpty(tlsClientCertPath) ? new FileInputStream(tlsClientCertPath) : null,!isNullOrEmpty(tlsClientKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsClientKeyPath,true) : null,!isNullOrEmpty(tlsClientKeyPassword) ? tlsClientKeyPassword : null).build();\n  }\n}\n else {\n  if (tlsTestModeEnable) {\n    SelfSignedCertificate selfSignedCertificate=new SelfSignedCertificate();\n    return SslContextBuilder.forServer(selfSignedCertificate.certificate(),selfSignedCertificate.privateKey()).sslProvider(SslProvider.JDK).clientAuth(ClientAuth.OPTIONAL).build();\n  }\n else {\n    SslContextBuilder sslContextBuilder=SslContextBuilder.forServer(!isNullOrEmpty(tlsServerCertPath) ? new FileInputStream(tlsServerCertPath) : null,!isNullOrEmpty(tlsServerKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsServerKeyPath,false) : null,!isNullOrEmpty(tlsServerKeyPassword) ? tlsServerKeyPassword : null).sslProvider(provider);\n    if (!tlsServerAuthClient) {\n      sslContextBuilder.trustManager(InsecureTrustManagerFactory.INSTANCE);\n    }\n else {\n      if (!isNullOrEmpty(tlsServerTrustCertPath)) {\n        sslContextBuilder.trustManager(new File(tlsServerTrustCertPath));\n      }\n    }\n    sslContextBuilder.clientAuth(parseClientAuthMode(tlsServerNeedClientAuth));\n    return sslContextBuilder.build();\n  }\n}\n",
      "nodeType" : "IfStatement",
      "astNodeNumber" : 207,
      "astHeight" : 13
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
      "nodePosition" : {
        "charLength" : 3042,
        "startLineNumber" : 91,
        "startColumnNumber" : 105,
        "endLineNumber" : 158,
        "endColumnNumber" : 5
      },
      "nodeContext" : "{\n  File configFile=new File(TlsSystemConfig.tlsConfigFile);\n  extractTlsConfigFromFile(configFile);\n  logTheFinalUsedTlsConfig();\n  SslProvider provider;\n  if (OpenSsl.isAvailable()) {\n    provider=SslProvider.OPENSSL;\n    LOGGER.info(\"Using OpenSSL provider\");\n  }\n else {\n    provider=SslProvider.JDK;\n    LOGGER.info(\"Using JDK SSL provider\");\n  }\n  if (forClient) {\n    if (tlsTestModeEnable) {\n      return SslContextBuilder.forClient().sslProvider(SslProvider.JDK).trustManager(InsecureTrustManagerFactory.INSTANCE).build();\n    }\n else {\n      SslContextBuilder sslContextBuilder=SslContextBuilder.forClient().sslProvider(SslProvider.JDK);\n      if (!tlsClientAuthServer) {\n        sslContextBuilder.trustManager(InsecureTrustManagerFactory.INSTANCE);\n      }\n else {\n        if (!isNullOrEmpty(tlsClientTrustCertPath)) {\n          sslContextBuilder.trustManager(new File(tlsClientTrustCertPath));\n        }\n      }\n      return sslContextBuilder.keyManager(!isNullOrEmpty(tlsClientCertPath) ? new FileInputStream(tlsClientCertPath) : null,!isNullOrEmpty(tlsClientKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsClientKeyPath,true) : null,!isNullOrEmpty(tlsClientKeyPassword) ? tlsClientKeyPassword : null).build();\n    }\n  }\n else {\n    if (tlsTestModeEnable) {\n      SelfSignedCertificate selfSignedCertificate=new SelfSignedCertificate();\n      return SslContextBuilder.forServer(selfSignedCertificate.certificate(),selfSignedCertificate.privateKey()).sslProvider(SslProvider.JDK).clientAuth(ClientAuth.OPTIONAL).build();\n    }\n else {\n      SslContextBuilder sslContextBuilder=SslContextBuilder.forServer(!isNullOrEmpty(tlsServerCertPath) ? new FileInputStream(tlsServerCertPath) : null,!isNullOrEmpty(tlsServerKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsServerKeyPath,false) : null,!isNullOrEmpty(tlsServerKeyPassword) ? tlsServerKeyPassword : null).sslProvider(provider);\n      if (!tlsServerAuthClient) {\n        sslContextBuilder.trustManager(InsecureTrustManagerFactory.INSTANCE);\n      }\n else {\n        if (!isNullOrEmpty(tlsServerTrustCertPath)) {\n          sslContextBuilder.trustManager(new File(tlsServerTrustCertPath));\n        }\n      }\n      sslContextBuilder.clientAuth(parseClientAuthMode(tlsServerNeedClientAuth));\n      return sslContextBuilder.build();\n    }\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 259,
      "astHeight" : 14
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
      "nodePosition" : {
        "charLength" : 3143,
        "startLineNumber" : 91,
        "startColumnNumber" : 4,
        "endLineNumber" : 158,
        "endColumnNumber" : 5
      },
      "nodeContext" : "public static SslContext buildSslContext(boolean forClient) throws IOException, CertificateException {\n  File configFile=new File(TlsSystemConfig.tlsConfigFile);\n  extractTlsConfigFromFile(configFile);\n  logTheFinalUsedTlsConfig();\n  SslProvider provider;\n  if (OpenSsl.isAvailable()) {\n    provider=SslProvider.OPENSSL;\n    LOGGER.info(\"Using OpenSSL provider\");\n  }\n else {\n    provider=SslProvider.JDK;\n    LOGGER.info(\"Using JDK SSL provider\");\n  }\n  if (forClient) {\n    if (tlsTestModeEnable) {\n      return SslContextBuilder.forClient().sslProvider(SslProvider.JDK).trustManager(InsecureTrustManagerFactory.INSTANCE).build();\n    }\n else {\n      SslContextBuilder sslContextBuilder=SslContextBuilder.forClient().sslProvider(SslProvider.JDK);\n      if (!tlsClientAuthServer) {\n        sslContextBuilder.trustManager(InsecureTrustManagerFactory.INSTANCE);\n      }\n else {\n        if (!isNullOrEmpty(tlsClientTrustCertPath)) {\n          sslContextBuilder.trustManager(new File(tlsClientTrustCertPath));\n        }\n      }\n      return sslContextBuilder.keyManager(!isNullOrEmpty(tlsClientCertPath) ? new FileInputStream(tlsClientCertPath) : null,!isNullOrEmpty(tlsClientKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsClientKeyPath,true) : null,!isNullOrEmpty(tlsClientKeyPassword) ? tlsClientKeyPassword : null).build();\n    }\n  }\n else {\n    if (tlsTestModeEnable) {\n      SelfSignedCertificate selfSignedCertificate=new SelfSignedCertificate();\n      return SslContextBuilder.forServer(selfSignedCertificate.certificate(),selfSignedCertificate.privateKey()).sslProvider(SslProvider.JDK).clientAuth(ClientAuth.OPTIONAL).build();\n    }\n else {\n      SslContextBuilder sslContextBuilder=SslContextBuilder.forServer(!isNullOrEmpty(tlsServerCertPath) ? new FileInputStream(tlsServerCertPath) : null,!isNullOrEmpty(tlsServerKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsServerKeyPath,false) : null,!isNullOrEmpty(tlsServerKeyPassword) ? tlsServerKeyPassword : null).sslProvider(provider);\n      if (!tlsServerAuthClient) {\n        sslContextBuilder.trustManager(InsecureTrustManagerFactory.INSTANCE);\n      }\n else {\n        if (!isNullOrEmpty(tlsServerTrustCertPath)) {\n          sslContextBuilder.trustManager(new File(tlsServerTrustCertPath));\n        }\n      }\n      sslContextBuilder.clientAuth(parseClientAuthMode(tlsServerNeedClientAuth));\n      return sslContextBuilder.build();\n    }\n  }\n}\n",
      "nodeType" : "MethodDeclaration",
      "astNodeNumber" : 272,
      "astHeight" : 15
    } ],
    "currentLineData" : {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
      "nodePosition" : {
        "charLength" : 103,
        "startLineNumber" : 142,
        "startColumnNumber" : 20,
        "endLineNumber" : 142,
        "endColumnNumber" : 123
      },
      "nodeContext" : "!isNullOrEmpty(tlsServerKeyPath) ? decryptionStrategy.decryptPrivateKey(tlsServerKeyPath,false) : null",
      "nodeType" : "ConditionalExpression",
      "astNodeNumber" : 11,
      "astHeight" : 4
    },
    "tokenLength" : 2,
    "type" : "boolean"
  } ],
  "positionList" : [ {
    "charLength" : 32,
    "startLineNumber" : 142,
    "startColumnNumber" : 20,
    "endLineNumber" : 142,
    "endColumnNumber" : 52
  } ],
  "layoutRelationDataList" : [ ]
}