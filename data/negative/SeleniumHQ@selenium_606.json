{
  "id" : 606,
  "expression" : "AttributeKey",
  "projectName" : "SeleniumHQ@selenium",
  "commitID" : "738dd0ee18a142d3fe69fc5f16889ac770188c93",
  "filePath" : "java/server/src/org/openqa/selenium/grid/node/config/DriverServiceSessionFactory.java",
  "occurrences" : 7,
  "isArithmeticExpression" : 0,
  "isGetTypeMethod" : 0,
  "expressionList" : [ {
    "nodeContext" : "AttributeKey",
    "nodeType" : "SimpleName",
    "nodePosition" : {
      "charLength" : 12,
      "startLineNumber" : 95,
      "startColumnNumber" : 23,
      "endLineNumber" : 95,
      "endColumnNumber" : 35
    },
    "astNodeNumber" : 1,
    "astHeight" : 1,
    "parentDataList" : [ {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodInvocation,expression]",
      "nodePosition" : {
        "charLength" : 25,
        "startLineNumber" : 95,
        "startColumnNumber" : 23,
        "endLineNumber" : 95,
        "endColumnNumber" : 48
      },
      "nodeContext" : "AttributeKey.LOGGER_CLASS",
      "nodeType" : "QualifiedName",
      "astNodeNumber" : 3,
      "astHeight" : 2
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
      "nodePosition" : {
        "charLength" : 34,
        "startLineNumber" : 95,
        "startColumnNumber" : 23,
        "endLineNumber" : 95,
        "endColumnNumber" : 57
      },
      "nodeContext" : "AttributeKey.LOGGER_CLASS.getKey()",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 5,
      "astHeight" : 3
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
      "nodePosition" : {
        "charLength" : 104,
        "startLineNumber" : 95,
        "startColumnNumber" : 6,
        "endLineNumber" : 95,
        "endColumnNumber" : 110
      },
      "nodeContext" : "attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()))",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 16,
      "astHeight" : 5
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 105,
        "startLineNumber" : 95,
        "startColumnNumber" : 6,
        "endLineNumber" : 95,
        "endColumnNumber" : 111
      },
      "nodeContext" : "attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 17,
      "astHeight" : 6
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
      "nodePosition" : {
        "charLength" : 3170,
        "startLineNumber" : 90,
        "startColumnNumber" : 92,
        "endLineNumber" : 162,
        "endColumnNumber" : 5
      },
      "nodeContext" : "{\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 385,
      "astHeight" : 12
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 3317,
        "startLineNumber" : 90,
        "startColumnNumber" : 4,
        "endLineNumber" : 164,
        "endColumnNumber" : 5
      },
      "nodeContext" : "try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n catch (Exception e) {\n  return Optional.empty();\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 407,
      "astHeight" : 13
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
      "nodePosition" : {
        "charLength" : 3514,
        "startLineNumber" : 81,
        "startColumnNumber" : 76,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "{\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 431,
      "astHeight" : 14
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
      "nodePosition" : {
        "charLength" : 3600,
        "startLineNumber" : 80,
        "startColumnNumber" : 2,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "@Override public Optional<ActiveSession> apply(CreateSessionRequest sessionRequest){\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "MethodDeclaration",
      "astNodeNumber" : 445,
      "astHeight" : 15
    } ],
    "currentLineData" : {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 105,
        "startLineNumber" : 95,
        "startColumnNumber" : 6,
        "endLineNumber" : 95,
        "endColumnNumber" : 111
      },
      "nodeContext" : "attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 17,
      "astHeight" : 6
    },
    "tokenLength" : 1,
    "type" : "org.openqa.selenium.remote.tracing.AttributeKey"
  }, {
    "nodeContext" : "AttributeKey",
    "nodeType" : "SimpleName",
    "nodePosition" : {
      "charLength" : 12,
      "startLineNumber" : 102,
      "startColumnNumber" : 25,
      "endLineNumber" : 102,
      "endColumnNumber" : 37
    },
    "astNodeNumber" : 1,
    "astHeight" : 1,
    "parentDataList" : [ {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodInvocation,expression]",
      "nodePosition" : {
        "charLength" : 23,
        "startLineNumber" : 102,
        "startColumnNumber" : 25,
        "endLineNumber" : 102,
        "endColumnNumber" : 48
      },
      "nodeContext" : "AttributeKey.DRIVER_URL",
      "nodeType" : "QualifiedName",
      "astNodeNumber" : 3,
      "astHeight" : 2
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
      "nodePosition" : {
        "charLength" : 32,
        "startLineNumber" : 102,
        "startColumnNumber" : 25,
        "endLineNumber" : 102,
        "endColumnNumber" : 57
      },
      "nodeContext" : "AttributeKey.DRIVER_URL.getKey()",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 5,
      "astHeight" : 3
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
      "nodePosition" : {
        "charLength" : 98,
        "startLineNumber" : 102,
        "startColumnNumber" : 8,
        "endLineNumber" : 102,
        "endColumnNumber" : 106
      },
      "nodeContext" : "attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()))",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 14,
      "astHeight" : 4
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 99,
        "startLineNumber" : 102,
        "startColumnNumber" : 8,
        "endLineNumber" : 102,
        "endColumnNumber" : 107
      },
      "nodeContext" : "attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 15,
      "astHeight" : 5
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
      "nodePosition" : {
        "charLength" : 2238,
        "startLineNumber" : 98,
        "startColumnNumber" : 10,
        "endLineNumber" : 152,
        "endColumnNumber" : 7
      },
      "nodeContext" : "{\n  service.start();\n  URL serviceURL=service.getUrl();\n  attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n  HttpClient client=clientFactory.createClient(serviceURL);\n  Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n  ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n  Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n  Dialect upstream=result.getDialect();\n  Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n  Response response=result.createResponse();\n  attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n  attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n  attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n  Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n  Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n  if (reportedUri.isPresent()) {\n    caps=addCdpCapability(caps,reportedUri.get());\n  }\n else {\n    reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n  }\n  span.addEvent(\"Driver service created session\",attributeMap);\n  return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n    @Override public void stop(){\n      service.stop();\n    }\n  }\n);\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 264,
      "astHeight" : 10
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 2749,
        "startLineNumber" : 98,
        "startColumnNumber" : 6,
        "endLineNumber" : 161,
        "endColumnNumber" : 7
      },
      "nodeContext" : "try {\n  service.start();\n  URL serviceURL=service.getUrl();\n  attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n  HttpClient client=clientFactory.createClient(serviceURL);\n  Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n  ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n  Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n  Dialect upstream=result.getDialect();\n  Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n  Response response=result.createResponse();\n  attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n  attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n  attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n  Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n  Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n  if (reportedUri.isPresent()) {\n    caps=addCdpCapability(caps,reportedUri.get());\n  }\n else {\n    reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n  }\n  span.addEvent(\"Driver service created session\",attributeMap);\n  return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n    @Override public void stop(){\n      service.stop();\n    }\n  }\n);\n}\n catch (Exception e) {\n  span.setAttribute(\"error\",true);\n  span.setStatus(Status.CANCELLED);\n  EXCEPTION.accept(attributeMap,e);\n  attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n  span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n  service.stop();\n  return Optional.empty();\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 325,
      "astHeight" : 11
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
      "nodePosition" : {
        "charLength" : 3170,
        "startLineNumber" : 90,
        "startColumnNumber" : 92,
        "endLineNumber" : 162,
        "endColumnNumber" : 5
      },
      "nodeContext" : "{\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 385,
      "astHeight" : 12
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 3317,
        "startLineNumber" : 90,
        "startColumnNumber" : 4,
        "endLineNumber" : 164,
        "endColumnNumber" : 5
      },
      "nodeContext" : "try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n catch (Exception e) {\n  return Optional.empty();\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 407,
      "astHeight" : 13
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
      "nodePosition" : {
        "charLength" : 3514,
        "startLineNumber" : 81,
        "startColumnNumber" : 76,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "{\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 431,
      "astHeight" : 14
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
      "nodePosition" : {
        "charLength" : 3600,
        "startLineNumber" : 80,
        "startColumnNumber" : 2,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "@Override public Optional<ActiveSession> apply(CreateSessionRequest sessionRequest){\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "MethodDeclaration",
      "astNodeNumber" : 445,
      "astHeight" : 15
    } ],
    "currentLineData" : {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 99,
        "startLineNumber" : 102,
        "startColumnNumber" : 8,
        "endLineNumber" : 102,
        "endColumnNumber" : 107
      },
      "nodeContext" : "attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 15,
      "astHeight" : 5
    },
    "tokenLength" : 1,
    "type" : "org.openqa.selenium.remote.tracing.AttributeKey"
  }, {
    "nodeContext" : "AttributeKey",
    "nodeType" : "SimpleName",
    "nodePosition" : {
      "charLength" : 12,
      "startLineNumber" : 119,
      "startColumnNumber" : 25,
      "endLineNumber" : 119,
      "endColumnNumber" : 37
    },
    "astNodeNumber" : 1,
    "astHeight" : 1,
    "parentDataList" : [ {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodInvocation,expression]",
      "nodePosition" : {
        "charLength" : 29,
        "startLineNumber" : 119,
        "startColumnNumber" : 25,
        "endLineNumber" : 119,
        "endColumnNumber" : 54
      },
      "nodeContext" : "AttributeKey.UPSTREAM_DIALECT",
      "nodeType" : "QualifiedName",
      "astNodeNumber" : 3,
      "astHeight" : 2
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
      "nodePosition" : {
        "charLength" : 38,
        "startLineNumber" : 119,
        "startColumnNumber" : 25,
        "endLineNumber" : 119,
        "endColumnNumber" : 63
      },
      "nodeContext" : "AttributeKey.UPSTREAM_DIALECT.getKey()",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 5,
      "astHeight" : 3
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
      "nodePosition" : {
        "charLength" : 102,
        "startLineNumber" : 119,
        "startColumnNumber" : 8,
        "endLineNumber" : 119,
        "endColumnNumber" : 110
      },
      "nodeContext" : "attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()))",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 14,
      "astHeight" : 4
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 103,
        "startLineNumber" : 119,
        "startColumnNumber" : 8,
        "endLineNumber" : 119,
        "endColumnNumber" : 111
      },
      "nodeContext" : "attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 15,
      "astHeight" : 5
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
      "nodePosition" : {
        "charLength" : 2238,
        "startLineNumber" : 98,
        "startColumnNumber" : 10,
        "endLineNumber" : 152,
        "endColumnNumber" : 7
      },
      "nodeContext" : "{\n  service.start();\n  URL serviceURL=service.getUrl();\n  attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n  HttpClient client=clientFactory.createClient(serviceURL);\n  Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n  ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n  Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n  Dialect upstream=result.getDialect();\n  Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n  Response response=result.createResponse();\n  attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n  attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n  attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n  Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n  Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n  if (reportedUri.isPresent()) {\n    caps=addCdpCapability(caps,reportedUri.get());\n  }\n else {\n    reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n  }\n  span.addEvent(\"Driver service created session\",attributeMap);\n  return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n    @Override public void stop(){\n      service.stop();\n    }\n  }\n);\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 264,
      "astHeight" : 10
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 2749,
        "startLineNumber" : 98,
        "startColumnNumber" : 6,
        "endLineNumber" : 161,
        "endColumnNumber" : 7
      },
      "nodeContext" : "try {\n  service.start();\n  URL serviceURL=service.getUrl();\n  attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n  HttpClient client=clientFactory.createClient(serviceURL);\n  Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n  ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n  Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n  Dialect upstream=result.getDialect();\n  Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n  Response response=result.createResponse();\n  attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n  attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n  attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n  Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n  Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n  if (reportedUri.isPresent()) {\n    caps=addCdpCapability(caps,reportedUri.get());\n  }\n else {\n    reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n  }\n  span.addEvent(\"Driver service created session\",attributeMap);\n  return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n    @Override public void stop(){\n      service.stop();\n    }\n  }\n);\n}\n catch (Exception e) {\n  span.setAttribute(\"error\",true);\n  span.setStatus(Status.CANCELLED);\n  EXCEPTION.accept(attributeMap,e);\n  attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n  span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n  service.stop();\n  return Optional.empty();\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 325,
      "astHeight" : 11
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
      "nodePosition" : {
        "charLength" : 3170,
        "startLineNumber" : 90,
        "startColumnNumber" : 92,
        "endLineNumber" : 162,
        "endColumnNumber" : 5
      },
      "nodeContext" : "{\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 385,
      "astHeight" : 12
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 3317,
        "startLineNumber" : 90,
        "startColumnNumber" : 4,
        "endLineNumber" : 164,
        "endColumnNumber" : 5
      },
      "nodeContext" : "try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n catch (Exception e) {\n  return Optional.empty();\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 407,
      "astHeight" : 13
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
      "nodePosition" : {
        "charLength" : 3514,
        "startLineNumber" : 81,
        "startColumnNumber" : 76,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "{\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 431,
      "astHeight" : 14
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
      "nodePosition" : {
        "charLength" : 3600,
        "startLineNumber" : 80,
        "startColumnNumber" : 2,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "@Override public Optional<ActiveSession> apply(CreateSessionRequest sessionRequest){\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "MethodDeclaration",
      "astNodeNumber" : 445,
      "astHeight" : 15
    } ],
    "currentLineData" : {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 103,
        "startLineNumber" : 119,
        "startColumnNumber" : 8,
        "endLineNumber" : 119,
        "endColumnNumber" : 111
      },
      "nodeContext" : "attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 15,
      "astHeight" : 5
    },
    "tokenLength" : 1,
    "type" : "org.openqa.selenium.remote.tracing.AttributeKey"
  }, {
    "nodeContext" : "AttributeKey",
    "nodeType" : "SimpleName",
    "nodePosition" : {
      "charLength" : 12,
      "startLineNumber" : 120,
      "startColumnNumber" : 25,
      "endLineNumber" : 120,
      "endColumnNumber" : 37
    },
    "astNodeNumber" : 1,
    "astHeight" : 1,
    "parentDataList" : [ {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodInvocation,expression]",
      "nodePosition" : {
        "charLength" : 31,
        "startLineNumber" : 120,
        "startColumnNumber" : 25,
        "endLineNumber" : 120,
        "endColumnNumber" : 56
      },
      "nodeContext" : "AttributeKey.DOWNSTREAM_DIALECT",
      "nodeType" : "QualifiedName",
      "astNodeNumber" : 3,
      "astHeight" : 2
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
      "nodePosition" : {
        "charLength" : 40,
        "startLineNumber" : 120,
        "startColumnNumber" : 25,
        "endLineNumber" : 120,
        "endColumnNumber" : 65
      },
      "nodeContext" : "AttributeKey.DOWNSTREAM_DIALECT.getKey()",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 5,
      "astHeight" : 3
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
      "nodePosition" : {
        "charLength" : 106,
        "startLineNumber" : 120,
        "startColumnNumber" : 8,
        "endLineNumber" : 120,
        "endColumnNumber" : 114
      },
      "nodeContext" : "attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()))",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 14,
      "astHeight" : 4
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 107,
        "startLineNumber" : 120,
        "startColumnNumber" : 8,
        "endLineNumber" : 120,
        "endColumnNumber" : 115
      },
      "nodeContext" : "attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 15,
      "astHeight" : 5
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
      "nodePosition" : {
        "charLength" : 2238,
        "startLineNumber" : 98,
        "startColumnNumber" : 10,
        "endLineNumber" : 152,
        "endColumnNumber" : 7
      },
      "nodeContext" : "{\n  service.start();\n  URL serviceURL=service.getUrl();\n  attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n  HttpClient client=clientFactory.createClient(serviceURL);\n  Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n  ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n  Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n  Dialect upstream=result.getDialect();\n  Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n  Response response=result.createResponse();\n  attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n  attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n  attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n  Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n  Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n  if (reportedUri.isPresent()) {\n    caps=addCdpCapability(caps,reportedUri.get());\n  }\n else {\n    reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n  }\n  span.addEvent(\"Driver service created session\",attributeMap);\n  return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n    @Override public void stop(){\n      service.stop();\n    }\n  }\n);\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 264,
      "astHeight" : 10
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 2749,
        "startLineNumber" : 98,
        "startColumnNumber" : 6,
        "endLineNumber" : 161,
        "endColumnNumber" : 7
      },
      "nodeContext" : "try {\n  service.start();\n  URL serviceURL=service.getUrl();\n  attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n  HttpClient client=clientFactory.createClient(serviceURL);\n  Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n  ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n  Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n  Dialect upstream=result.getDialect();\n  Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n  Response response=result.createResponse();\n  attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n  attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n  attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n  Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n  Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n  if (reportedUri.isPresent()) {\n    caps=addCdpCapability(caps,reportedUri.get());\n  }\n else {\n    reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n  }\n  span.addEvent(\"Driver service created session\",attributeMap);\n  return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n    @Override public void stop(){\n      service.stop();\n    }\n  }\n);\n}\n catch (Exception e) {\n  span.setAttribute(\"error\",true);\n  span.setStatus(Status.CANCELLED);\n  EXCEPTION.accept(attributeMap,e);\n  attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n  span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n  service.stop();\n  return Optional.empty();\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 325,
      "astHeight" : 11
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
      "nodePosition" : {
        "charLength" : 3170,
        "startLineNumber" : 90,
        "startColumnNumber" : 92,
        "endLineNumber" : 162,
        "endColumnNumber" : 5
      },
      "nodeContext" : "{\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 385,
      "astHeight" : 12
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 3317,
        "startLineNumber" : 90,
        "startColumnNumber" : 4,
        "endLineNumber" : 164,
        "endColumnNumber" : 5
      },
      "nodeContext" : "try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n catch (Exception e) {\n  return Optional.empty();\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 407,
      "astHeight" : 13
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
      "nodePosition" : {
        "charLength" : 3514,
        "startLineNumber" : 81,
        "startColumnNumber" : 76,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "{\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 431,
      "astHeight" : 14
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
      "nodePosition" : {
        "charLength" : 3600,
        "startLineNumber" : 80,
        "startColumnNumber" : 2,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "@Override public Optional<ActiveSession> apply(CreateSessionRequest sessionRequest){\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "MethodDeclaration",
      "astNodeNumber" : 445,
      "astHeight" : 15
    } ],
    "currentLineData" : {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 107,
        "startLineNumber" : 120,
        "startColumnNumber" : 8,
        "endLineNumber" : 120,
        "endColumnNumber" : 115
      },
      "nodeContext" : "attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 15,
      "astHeight" : 5
    },
    "tokenLength" : 1,
    "type" : "org.openqa.selenium.remote.tracing.AttributeKey"
  }, {
    "nodeContext" : "AttributeKey",
    "nodeType" : "SimpleName",
    "nodePosition" : {
      "charLength" : 12,
      "startLineNumber" : 121,
      "startColumnNumber" : 25,
      "endLineNumber" : 121,
      "endColumnNumber" : 37
    },
    "astNodeNumber" : 1,
    "astHeight" : 1,
    "parentDataList" : [ {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodInvocation,expression]",
      "nodePosition" : {
        "charLength" : 28,
        "startLineNumber" : 121,
        "startColumnNumber" : 25,
        "endLineNumber" : 121,
        "endColumnNumber" : 53
      },
      "nodeContext" : "AttributeKey.DRIVER_RESPONSE",
      "nodeType" : "QualifiedName",
      "astNodeNumber" : 3,
      "astHeight" : 2
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
      "nodePosition" : {
        "charLength" : 37,
        "startLineNumber" : 121,
        "startColumnNumber" : 25,
        "endLineNumber" : 121,
        "endColumnNumber" : 62
      },
      "nodeContext" : "AttributeKey.DRIVER_RESPONSE.getKey()",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 5,
      "astHeight" : 3
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
      "nodePosition" : {
        "charLength" : 101,
        "startLineNumber" : 121,
        "startColumnNumber" : 8,
        "endLineNumber" : 121,
        "endColumnNumber" : 109
      },
      "nodeContext" : "attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()))",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 14,
      "astHeight" : 4
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 102,
        "startLineNumber" : 121,
        "startColumnNumber" : 8,
        "endLineNumber" : 121,
        "endColumnNumber" : 110
      },
      "nodeContext" : "attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 15,
      "astHeight" : 5
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
      "nodePosition" : {
        "charLength" : 2238,
        "startLineNumber" : 98,
        "startColumnNumber" : 10,
        "endLineNumber" : 152,
        "endColumnNumber" : 7
      },
      "nodeContext" : "{\n  service.start();\n  URL serviceURL=service.getUrl();\n  attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n  HttpClient client=clientFactory.createClient(serviceURL);\n  Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n  ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n  Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n  Dialect upstream=result.getDialect();\n  Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n  Response response=result.createResponse();\n  attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n  attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n  attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n  Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n  Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n  if (reportedUri.isPresent()) {\n    caps=addCdpCapability(caps,reportedUri.get());\n  }\n else {\n    reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n  }\n  span.addEvent(\"Driver service created session\",attributeMap);\n  return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n    @Override public void stop(){\n      service.stop();\n    }\n  }\n);\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 264,
      "astHeight" : 10
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 2749,
        "startLineNumber" : 98,
        "startColumnNumber" : 6,
        "endLineNumber" : 161,
        "endColumnNumber" : 7
      },
      "nodeContext" : "try {\n  service.start();\n  URL serviceURL=service.getUrl();\n  attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n  HttpClient client=clientFactory.createClient(serviceURL);\n  Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n  ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n  Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n  Dialect upstream=result.getDialect();\n  Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n  Response response=result.createResponse();\n  attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n  attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n  attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n  Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n  Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n  if (reportedUri.isPresent()) {\n    caps=addCdpCapability(caps,reportedUri.get());\n  }\n else {\n    reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n  }\n  span.addEvent(\"Driver service created session\",attributeMap);\n  return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n    @Override public void stop(){\n      service.stop();\n    }\n  }\n);\n}\n catch (Exception e) {\n  span.setAttribute(\"error\",true);\n  span.setStatus(Status.CANCELLED);\n  EXCEPTION.accept(attributeMap,e);\n  attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n  span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n  service.stop();\n  return Optional.empty();\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 325,
      "astHeight" : 11
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
      "nodePosition" : {
        "charLength" : 3170,
        "startLineNumber" : 90,
        "startColumnNumber" : 92,
        "endLineNumber" : 162,
        "endColumnNumber" : 5
      },
      "nodeContext" : "{\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 385,
      "astHeight" : 12
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 3317,
        "startLineNumber" : 90,
        "startColumnNumber" : 4,
        "endLineNumber" : 164,
        "endColumnNumber" : 5
      },
      "nodeContext" : "try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n catch (Exception e) {\n  return Optional.empty();\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 407,
      "astHeight" : 13
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
      "nodePosition" : {
        "charLength" : 3514,
        "startLineNumber" : 81,
        "startColumnNumber" : 76,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "{\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 431,
      "astHeight" : 14
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
      "nodePosition" : {
        "charLength" : 3600,
        "startLineNumber" : 80,
        "startColumnNumber" : 2,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "@Override public Optional<ActiveSession> apply(CreateSessionRequest sessionRequest){\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "MethodDeclaration",
      "astNodeNumber" : 445,
      "astHeight" : 15
    } ],
    "currentLineData" : {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 102,
        "startLineNumber" : 121,
        "startColumnNumber" : 8,
        "endLineNumber" : 121,
        "endColumnNumber" : 110
      },
      "nodeContext" : "attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 15,
      "astHeight" : 5
    },
    "tokenLength" : 1,
    "type" : "org.openqa.selenium.remote.tracing.AttributeKey"
  }, {
    "nodeContext" : "AttributeKey",
    "nodeType" : "SimpleName",
    "nodePosition" : {
      "charLength" : 12,
      "startLineNumber" : 156,
      "startColumnNumber" : 25,
      "endLineNumber" : 156,
      "endColumnNumber" : 37
    },
    "astNodeNumber" : 1,
    "astHeight" : 1,
    "parentDataList" : [ {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodInvocation,expression]",
      "nodePosition" : {
        "charLength" : 30,
        "startLineNumber" : 156,
        "startColumnNumber" : 25,
        "endLineNumber" : 156,
        "endColumnNumber" : 55
      },
      "nodeContext" : "AttributeKey.EXCEPTION_MESSAGE",
      "nodeType" : "QualifiedName",
      "astNodeNumber" : 3,
      "astHeight" : 2
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
      "nodePosition" : {
        "charLength" : 39,
        "startLineNumber" : 156,
        "startColumnNumber" : 25,
        "endLineNumber" : 156,
        "endColumnNumber" : 64
      },
      "nodeContext" : "AttributeKey.EXCEPTION_MESSAGE.getKey()",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 5,
      "astHeight" : 3
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
      "nodePosition" : {
        "charLength" : 207,
        "startLineNumber" : 156,
        "startColumnNumber" : 8,
        "endLineNumber" : 157,
        "endColumnNumber" : 149
      },
      "nodeContext" : "attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()))",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 16,
      "astHeight" : 5
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 208,
        "startLineNumber" : 156,
        "startColumnNumber" : 8,
        "endLineNumber" : 157,
        "endColumnNumber" : 150
      },
      "nodeContext" : "attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 17,
      "astHeight" : 6
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.CatchClause,body]",
      "nodePosition" : {
        "charLength" : 486,
        "startLineNumber" : 152,
        "startColumnNumber" : 28,
        "endLineNumber" : 161,
        "endColumnNumber" : 7
      },
      "nodeContext" : "{\n  span.setAttribute(\"error\",true);\n  span.setStatus(Status.CANCELLED);\n  EXCEPTION.accept(attributeMap,e);\n  attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n  span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n  service.stop();\n  return Optional.empty();\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 55,
      "astHeight" : 7
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TryStatement,catchClauses]",
      "nodePosition" : {
        "charLength" : 506,
        "startLineNumber" : 152,
        "startColumnNumber" : 8,
        "endLineNumber" : 161,
        "endColumnNumber" : 7
      },
      "nodeContext" : "catch (Exception e) {\n  span.setAttribute(\"error\",true);\n  span.setStatus(Status.CANCELLED);\n  EXCEPTION.accept(attributeMap,e);\n  attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n  span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n  service.stop();\n  return Optional.empty();\n}\n",
      "nodeType" : "CatchClause",
      "astNodeNumber" : 60,
      "astHeight" : 8
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 2749,
        "startLineNumber" : 98,
        "startColumnNumber" : 6,
        "endLineNumber" : 161,
        "endColumnNumber" : 7
      },
      "nodeContext" : "try {\n  service.start();\n  URL serviceURL=service.getUrl();\n  attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n  HttpClient client=clientFactory.createClient(serviceURL);\n  Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n  ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n  Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n  Dialect upstream=result.getDialect();\n  Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n  Response response=result.createResponse();\n  attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n  attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n  attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n  Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n  Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n  if (reportedUri.isPresent()) {\n    caps=addCdpCapability(caps,reportedUri.get());\n  }\n else {\n    reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n  }\n  span.addEvent(\"Driver service created session\",attributeMap);\n  return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n    @Override public void stop(){\n      service.stop();\n    }\n  }\n);\n}\n catch (Exception e) {\n  span.setAttribute(\"error\",true);\n  span.setStatus(Status.CANCELLED);\n  EXCEPTION.accept(attributeMap,e);\n  attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n  span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n  service.stop();\n  return Optional.empty();\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 325,
      "astHeight" : 11
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
      "nodePosition" : {
        "charLength" : 3170,
        "startLineNumber" : 90,
        "startColumnNumber" : 92,
        "endLineNumber" : 162,
        "endColumnNumber" : 5
      },
      "nodeContext" : "{\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 385,
      "astHeight" : 12
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 3317,
        "startLineNumber" : 90,
        "startColumnNumber" : 4,
        "endLineNumber" : 164,
        "endColumnNumber" : 5
      },
      "nodeContext" : "try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n catch (Exception e) {\n  return Optional.empty();\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 407,
      "astHeight" : 13
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
      "nodePosition" : {
        "charLength" : 3514,
        "startLineNumber" : 81,
        "startColumnNumber" : 76,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "{\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 431,
      "astHeight" : 14
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
      "nodePosition" : {
        "charLength" : 3600,
        "startLineNumber" : 80,
        "startColumnNumber" : 2,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "@Override public Optional<ActiveSession> apply(CreateSessionRequest sessionRequest){\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "MethodDeclaration",
      "astNodeNumber" : 445,
      "astHeight" : 15
    } ],
    "currentLineData" : {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
      "nodePosition" : {
        "charLength" : 39,
        "startLineNumber" : 156,
        "startColumnNumber" : 25,
        "endLineNumber" : 156,
        "endColumnNumber" : 64
      },
      "nodeContext" : "AttributeKey.EXCEPTION_MESSAGE.getKey()",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 5,
      "astHeight" : 3
    },
    "tokenLength" : 1,
    "type" : "org.openqa.selenium.remote.tracing.AttributeKey"
  }, {
    "nodeContext" : "AttributeKey",
    "nodeType" : "SimpleName",
    "nodePosition" : {
      "charLength" : 12,
      "startLineNumber" : 158,
      "startColumnNumber" : 22,
      "endLineNumber" : 158,
      "endColumnNumber" : 34
    },
    "astNodeNumber" : 1,
    "astHeight" : 1,
    "parentDataList" : [ {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodInvocation,expression]",
      "nodePosition" : {
        "charLength" : 28,
        "startLineNumber" : 158,
        "startColumnNumber" : 22,
        "endLineNumber" : 158,
        "endColumnNumber" : 50
      },
      "nodeContext" : "AttributeKey.EXCEPTION_EVENT",
      "nodeType" : "QualifiedName",
      "astNodeNumber" : 3,
      "astHeight" : 2
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.MethodInvocation,arguments]",
      "nodePosition" : {
        "charLength" : 37,
        "startLineNumber" : 158,
        "startColumnNumber" : 22,
        "endLineNumber" : 158,
        "endColumnNumber" : 59
      },
      "nodeContext" : "AttributeKey.EXCEPTION_EVENT.getKey()",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 5,
      "astHeight" : 3
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
      "nodePosition" : {
        "charLength" : 66,
        "startLineNumber" : 158,
        "startColumnNumber" : 8,
        "endLineNumber" : 158,
        "endColumnNumber" : 74
      },
      "nodeContext" : "span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap)",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 9,
      "astHeight" : 4
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 67,
        "startLineNumber" : 158,
        "startColumnNumber" : 8,
        "endLineNumber" : 158,
        "endColumnNumber" : 75
      },
      "nodeContext" : "span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 10,
      "astHeight" : 5
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.CatchClause,body]",
      "nodePosition" : {
        "charLength" : 486,
        "startLineNumber" : 152,
        "startColumnNumber" : 28,
        "endLineNumber" : 161,
        "endColumnNumber" : 7
      },
      "nodeContext" : "{\n  span.setAttribute(\"error\",true);\n  span.setStatus(Status.CANCELLED);\n  EXCEPTION.accept(attributeMap,e);\n  attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n  span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n  service.stop();\n  return Optional.empty();\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 55,
      "astHeight" : 7
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TryStatement,catchClauses]",
      "nodePosition" : {
        "charLength" : 506,
        "startLineNumber" : 152,
        "startColumnNumber" : 8,
        "endLineNumber" : 161,
        "endColumnNumber" : 7
      },
      "nodeContext" : "catch (Exception e) {\n  span.setAttribute(\"error\",true);\n  span.setStatus(Status.CANCELLED);\n  EXCEPTION.accept(attributeMap,e);\n  attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n  span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n  service.stop();\n  return Optional.empty();\n}\n",
      "nodeType" : "CatchClause",
      "astNodeNumber" : 60,
      "astHeight" : 8
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 2749,
        "startLineNumber" : 98,
        "startColumnNumber" : 6,
        "endLineNumber" : 161,
        "endColumnNumber" : 7
      },
      "nodeContext" : "try {\n  service.start();\n  URL serviceURL=service.getUrl();\n  attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n  HttpClient client=clientFactory.createClient(serviceURL);\n  Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n  ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n  Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n  Dialect upstream=result.getDialect();\n  Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n  Response response=result.createResponse();\n  attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n  attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n  attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n  Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n  Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n  if (reportedUri.isPresent()) {\n    caps=addCdpCapability(caps,reportedUri.get());\n  }\n else {\n    reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n  }\n  span.addEvent(\"Driver service created session\",attributeMap);\n  return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n    @Override public void stop(){\n      service.stop();\n    }\n  }\n);\n}\n catch (Exception e) {\n  span.setAttribute(\"error\",true);\n  span.setStatus(Status.CANCELLED);\n  EXCEPTION.accept(attributeMap,e);\n  attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n  span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n  service.stop();\n  return Optional.empty();\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 325,
      "astHeight" : 11
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.TryStatement,body]",
      "nodePosition" : {
        "charLength" : 3170,
        "startLineNumber" : 90,
        "startColumnNumber" : 92,
        "endLineNumber" : 162,
        "endColumnNumber" : 5
      },
      "nodeContext" : "{\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 385,
      "astHeight" : 12
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 3317,
        "startLineNumber" : 90,
        "startColumnNumber" : 4,
        "endLineNumber" : 164,
        "endColumnNumber" : 5
      },
      "nodeContext" : "try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n  Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n  Capabilities capabilities=sessionRequest.getCapabilities();\n  CAPABILITIES.accept(span,capabilities);\n  CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n  attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n  DriverService service=builder.build();\n  try {\n    service.start();\n    URL serviceURL=service.getUrl();\n    attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n    HttpClient client=clientFactory.createClient(serviceURL);\n    Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n    ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n    Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n    Dialect upstream=result.getDialect();\n    Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n    Response response=result.createResponse();\n    attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n    attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n    attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n    Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n    Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n    if (reportedUri.isPresent()) {\n      caps=addCdpCapability(caps,reportedUri.get());\n    }\n else {\n      reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n    }\n    span.addEvent(\"Driver service created session\",attributeMap);\n    return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n      @Override public void stop(){\n        service.stop();\n      }\n    }\n);\n  }\n catch (  Exception e) {\n    span.setAttribute(\"error\",true);\n    span.setStatus(Status.CANCELLED);\n    EXCEPTION.accept(attributeMap,e);\n    attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n    span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n    service.stop();\n    return Optional.empty();\n  }\n}\n catch (Exception e) {\n  return Optional.empty();\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 407,
      "astHeight" : 13
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
      "nodePosition" : {
        "charLength" : 3514,
        "startLineNumber" : 81,
        "startColumnNumber" : 76,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "{\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 431,
      "astHeight" : 14
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
      "nodePosition" : {
        "charLength" : 3600,
        "startLineNumber" : 80,
        "startColumnNumber" : 2,
        "endLineNumber" : 165,
        "endColumnNumber" : 3
      },
      "nodeContext" : "@Override public Optional<ActiveSession> apply(CreateSessionRequest sessionRequest){\n  if (sessionRequest.getDownstreamDialects().isEmpty()) {\n    return Optional.empty();\n  }\n  if (!test(sessionRequest.getCapabilities())) {\n    return Optional.empty();\n  }\n  try (Span span=tracer.getCurrentContext().createSpan(\"driver_service_factory.apply\")){\n    Map<String,EventAttributeValue> attributeMap=new HashMap<>();\n    Capabilities capabilities=sessionRequest.getCapabilities();\n    CAPABILITIES.accept(span,capabilities);\n    CAPABILITIES_EVENT.accept(attributeMap,capabilities);\n    attributeMap.put(AttributeKey.LOGGER_CLASS.getKey(),EventAttribute.setValue(this.getClass().getName()));\n    DriverService service=builder.build();\n    try {\n      service.start();\n      URL serviceURL=service.getUrl();\n      attributeMap.put(AttributeKey.DRIVER_URL.getKey(),EventAttribute.setValue(serviceURL.toString()));\n      HttpClient client=clientFactory.createClient(serviceURL);\n      Command command=new Command(null,DriverCommand.NEW_SESSION(sessionRequest.getCapabilities()));\n      ProtocolHandshake.Result result=new ProtocolHandshake().createSession(client,command);\n      Set<Dialect> downstreamDialects=sessionRequest.getDownstreamDialects();\n      Dialect upstream=result.getDialect();\n      Dialect downstream=downstreamDialects.contains(result.getDialect()) ? result.getDialect() : downstreamDialects.iterator().next();\n      Response response=result.createResponse();\n      attributeMap.put(AttributeKey.UPSTREAM_DIALECT.getKey(),EventAttribute.setValue(upstream.toString()));\n      attributeMap.put(AttributeKey.DOWNSTREAM_DIALECT.getKey(),EventAttribute.setValue(downstream.toString()));\n      attributeMap.put(AttributeKey.DRIVER_RESPONSE.getKey(),EventAttribute.setValue(response.toString()));\n      Capabilities caps=new ImmutableCapabilities((Map<?,?>)response.getValue());\n      Optional<URI> reportedUri=ChromiumDevToolsLocator.getReportedUri(\"goog:chromeOptions\",caps);\n      if (reportedUri.isPresent()) {\n        caps=addCdpCapability(caps,reportedUri.get());\n      }\n else {\n        reportedUri=ChromiumDevToolsLocator.getReportedUri(\"ms:edgeOptions\",caps);\n        if (reportedUri.isPresent()) {\n          caps=addCdpCapability(caps,reportedUri.get());\n        }\n      }\n      span.addEvent(\"Driver service created session\",attributeMap);\n      return Optional.of(new ProtocolConvertingSession(tracer,client,new SessionId(response.getSessionId()),service.getUrl(),downstream,upstream,caps){\n        @Override public void stop(){\n          service.stop();\n        }\n      }\n);\n    }\n catch (    Exception e) {\n      span.setAttribute(\"error\",true);\n      span.setStatus(Status.CANCELLED);\n      EXCEPTION.accept(attributeMap,e);\n      attributeMap.put(AttributeKey.EXCEPTION_MESSAGE.getKey(),EventAttribute.setValue(\"Error while creating session with the driver service. Stopping driver service: \" + e.getMessage()));\n      span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n      service.stop();\n      return Optional.empty();\n    }\n  }\n catch (  Exception e) {\n    return Optional.empty();\n  }\n}\n",
      "nodeType" : "MethodDeclaration",
      "astNodeNumber" : 445,
      "astHeight" : 15
    } ],
    "currentLineData" : {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 67,
        "startLineNumber" : 158,
        "startColumnNumber" : 8,
        "endLineNumber" : 158,
        "endColumnNumber" : 75
      },
      "nodeContext" : "span.addEvent(AttributeKey.EXCEPTION_EVENT.getKey(),attributeMap);\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 10,
      "astHeight" : 5
    },
    "tokenLength" : 1,
    "type" : "org.openqa.selenium.remote.tracing.AttributeKey"
  } ],
  "positionList" : [ {
    "charLength" : 12,
    "startLineNumber" : 95,
    "startColumnNumber" : 23,
    "endLineNumber" : 95,
    "endColumnNumber" : 35
  }, {
    "charLength" : 12,
    "startLineNumber" : 102,
    "startColumnNumber" : 25,
    "endLineNumber" : 102,
    "endColumnNumber" : 37
  }, {
    "charLength" : 12,
    "startLineNumber" : 119,
    "startColumnNumber" : 25,
    "endLineNumber" : 119,
    "endColumnNumber" : 37
  }, {
    "charLength" : 12,
    "startLineNumber" : 120,
    "startColumnNumber" : 25,
    "endLineNumber" : 120,
    "endColumnNumber" : 37
  }, {
    "charLength" : 12,
    "startLineNumber" : 121,
    "startColumnNumber" : 25,
    "endLineNumber" : 121,
    "endColumnNumber" : 37
  }, {
    "charLength" : 12,
    "startLineNumber" : 156,
    "startColumnNumber" : 25,
    "endLineNumber" : 156,
    "endColumnNumber" : 37
  }, {
    "charLength" : 12,
    "startLineNumber" : 158,
    "startColumnNumber" : 22,
    "endLineNumber" : 158,
    "endColumnNumber" : 34
  } ],
  "layoutRelationDataList" : [ {
    "firstKey" : 0,
    "secondKey" : 1,
    "layout" : 4
  }, {
    "firstKey" : 0,
    "secondKey" : 2,
    "layout" : 4
  }, {
    "firstKey" : 0,
    "secondKey" : 3,
    "layout" : 4
  }, {
    "firstKey" : 0,
    "secondKey" : 4,
    "layout" : 4
  }, {
    "firstKey" : 0,
    "secondKey" : 5,
    "layout" : 4
  }, {
    "firstKey" : 0,
    "secondKey" : 6,
    "layout" : 4
  }, {
    "firstKey" : 1,
    "secondKey" : 0,
    "layout" : 6
  }, {
    "firstKey" : 1,
    "secondKey" : 2,
    "layout" : 4
  }, {
    "firstKey" : 1,
    "secondKey" : 3,
    "layout" : 4
  }, {
    "firstKey" : 1,
    "secondKey" : 4,
    "layout" : 4
  }, {
    "firstKey" : 1,
    "secondKey" : 5,
    "layout" : 5
  }, {
    "firstKey" : 1,
    "secondKey" : 6,
    "layout" : 5
  }, {
    "firstKey" : 2,
    "secondKey" : 0,
    "layout" : 6
  }, {
    "firstKey" : 2,
    "secondKey" : 1,
    "layout" : 4
  }, {
    "firstKey" : 2,
    "secondKey" : 3,
    "layout" : 4
  }, {
    "firstKey" : 2,
    "secondKey" : 4,
    "layout" : 4
  }, {
    "firstKey" : 2,
    "secondKey" : 5,
    "layout" : 5
  }, {
    "firstKey" : 2,
    "secondKey" : 6,
    "layout" : 5
  }, {
    "firstKey" : 3,
    "secondKey" : 0,
    "layout" : 6
  }, {
    "firstKey" : 3,
    "secondKey" : 1,
    "layout" : 4
  }, {
    "firstKey" : 3,
    "secondKey" : 2,
    "layout" : 4
  }, {
    "firstKey" : 3,
    "secondKey" : 4,
    "layout" : 4
  }, {
    "firstKey" : 3,
    "secondKey" : 5,
    "layout" : 5
  }, {
    "firstKey" : 3,
    "secondKey" : 6,
    "layout" : 5
  }, {
    "firstKey" : 4,
    "secondKey" : 0,
    "layout" : 6
  }, {
    "firstKey" : 4,
    "secondKey" : 1,
    "layout" : 4
  }, {
    "firstKey" : 4,
    "secondKey" : 2,
    "layout" : 4
  }, {
    "firstKey" : 4,
    "secondKey" : 3,
    "layout" : 4
  }, {
    "firstKey" : 4,
    "secondKey" : 5,
    "layout" : 5
  }, {
    "firstKey" : 4,
    "secondKey" : 6,
    "layout" : 5
  }, {
    "firstKey" : 5,
    "secondKey" : 0,
    "layout" : 7
  }, {
    "firstKey" : 5,
    "secondKey" : 1,
    "layout" : 6
  }, {
    "firstKey" : 5,
    "secondKey" : 2,
    "layout" : 6
  }, {
    "firstKey" : 5,
    "secondKey" : 3,
    "layout" : 6
  }, {
    "firstKey" : 5,
    "secondKey" : 4,
    "layout" : 6
  }, {
    "firstKey" : 5,
    "secondKey" : 6,
    "layout" : 4
  }, {
    "firstKey" : 6,
    "secondKey" : 0,
    "layout" : 7
  }, {
    "firstKey" : 6,
    "secondKey" : 1,
    "layout" : 6
  }, {
    "firstKey" : 6,
    "secondKey" : 2,
    "layout" : 6
  }, {
    "firstKey" : 6,
    "secondKey" : 3,
    "layout" : 6
  }, {
    "firstKey" : 6,
    "secondKey" : 4,
    "layout" : 6
  }, {
    "firstKey" : 6,
    "secondKey" : 5,
    "layout" : 4
  } ]
}