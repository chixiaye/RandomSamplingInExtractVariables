{
  "id" : 104,
  "expression" : "new String[]{smsSubQuery,mmsSubQuery}",
  "projectName" : "signalapp@Signal-Android",
  "commitID" : "7e91132e7ed62a58b5f347de252ab1eda3f43b90",
  "filePath" : "/app/src/main/java/org/thoughtcrime/securesms/database/MmsSmsDatabase.java",
  "occurrences" : 1,
  "isArithmeticExpression" : 0,
  "isGetTypeMethod" : 0,
  "expressionList" : [ {
    "nodeContext" : "new String[]{smsSubQuery,mmsSubQuery}",
    "nodeType" : "ArrayCreation",
    "nodePosition" : {
      "charLength" : 41,
      "startLineNumber" : 817,
      "startColumnNumber" : 77,
      "endLineNumber" : 817,
      "endColumnNumber" : 118
    },
    "astNodeNumber" : 8,
    "astHeight" : 4,
    "parentDataList" : [ {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.VariableDeclarationFragment,initializer]",
      "nodePosition" : {
        "charLength" : 90,
        "startLineNumber" : 817,
        "startColumnNumber" : 43,
        "endLineNumber" : 817,
        "endColumnNumber" : 133
      },
      "nodeContext" : "unionQueryBuilder.buildUnionQuery(new String[]{smsSubQuery,mmsSubQuery},order,limit)",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 13,
      "astHeight" : 5
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.VariableDeclarationStatement,fragments]",
      "nodePosition" : {
        "charLength" : 110,
        "startLineNumber" : 817,
        "startColumnNumber" : 23,
        "endLineNumber" : 817,
        "endColumnNumber" : 133
      },
      "nodeContext" : "unionQuery=unionQueryBuilder.buildUnionQuery(new String[]{smsSubQuery,mmsSubQuery},order,limit)",
      "nodeType" : "VariableDeclarationFragment",
      "astNodeNumber" : 15,
      "astHeight" : 6
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 130,
        "startLineNumber" : 817,
        "startColumnNumber" : 4,
        "endLineNumber" : 817,
        "endColumnNumber" : 134
      },
      "nodeContext" : "String unionQuery=unionQueryBuilder.buildUnionQuery(new String[]{smsSubQuery,mmsSubQuery},order,limit);\n",
      "nodeType" : "VariableDeclarationStatement",
      "astNodeNumber" : 18,
      "astHeight" : 7
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
      "nodePosition" : {
        "charLength" : 15812,
        "startLineNumber" : 617,
        "startColumnNumber" : 139,
        "endLineNumber" : 823,
        "endColumnNumber" : 3
      },
      "nodeContext" : "{\n  String attachmentJsonJoin;\n  if (includeAttachments) {\n    attachmentJsonJoin=\"json_group_array(json_object(\" + \"'\" + AttachmentDatabase.ROW_ID + \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.ROW_ID+ \", \"+ \"'\"+ AttachmentDatabase.UNIQUE_ID+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.UNIQUE_ID+ \", \"+ \"'\"+ AttachmentDatabase.MMS_ID+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.MMS_ID+ \",\"+ \"'\"+ AttachmentDatabase.SIZE+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.SIZE+ \", \"+ \"'\"+ AttachmentDatabase.FILE_NAME+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.FILE_NAME+ \", \"+ \"'\"+ AttachmentDatabase.DATA+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.DATA+ \", \"+ \"'\"+ AttachmentDatabase.CONTENT_TYPE+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.CONTENT_TYPE+ \", \"+ \"'\"+ AttachmentDatabase.CDN_NUMBER+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.CDN_NUMBER+ \", \"+ \"'\"+ AttachmentDatabase.CONTENT_LOCATION+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.CONTENT_LOCATION+ \", \"+ \"'\"+ AttachmentDatabase.FAST_PREFLIGHT_ID+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.FAST_PREFLIGHT_ID+ \", \"+ \"'\"+ AttachmentDatabase.VOICE_NOTE+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.VOICE_NOTE+ \", \"+ \"'\"+ AttachmentDatabase.BORDERLESS+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.BORDERLESS+ \", \"+ \"'\"+ AttachmentDatabase.VIDEO_GIF+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.VIDEO_GIF+ \", \"+ \"'\"+ AttachmentDatabase.WIDTH+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.WIDTH+ \", \"+ \"'\"+ AttachmentDatabase.HEIGHT+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.HEIGHT+ \", \"+ \"'\"+ AttachmentDatabase.QUOTE+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.QUOTE+ \", \"+ \"'\"+ AttachmentDatabase.CONTENT_DISPOSITION+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.CONTENT_DISPOSITION+ \", \"+ \"'\"+ AttachmentDatabase.NAME+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.NAME+ \", \"+ \"'\"+ AttachmentDatabase.TRANSFER_STATE+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.TRANSFER_STATE+ \", \"+ \"'\"+ AttachmentDatabase.CAPTION+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.CAPTION+ \", \"+ \"'\"+ AttachmentDatabase.STICKER_PACK_ID+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.STICKER_PACK_ID+ \", \"+ \"'\"+ AttachmentDatabase.STICKER_PACK_KEY+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.STICKER_PACK_KEY+ \", \"+ \"'\"+ AttachmentDatabase.STICKER_ID+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.STICKER_ID+ \", \"+ \"'\"+ AttachmentDatabase.STICKER_EMOJI+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.STICKER_EMOJI+ \", \"+ \"'\"+ AttachmentDatabase.VISUAL_HASH+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.VISUAL_HASH+ \", \"+ \"'\"+ AttachmentDatabase.TRANSFORM_PROPERTIES+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.TRANSFORM_PROPERTIES+ \", \"+ \"'\"+ AttachmentDatabase.DISPLAY_ORDER+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.DISPLAY_ORDER+ \", \"+ \"'\"+ AttachmentDatabase.UPLOAD_TIMESTAMP+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.UPLOAD_TIMESTAMP+ \"))\";\n  }\n else {\n    attachmentJsonJoin=\"NULL\";\n  }\n  String[] mmsProjection={MmsDatabase.DATE_SENT + \" AS \" + MmsSmsColumns.NORMALIZED_DATE_SENT,MmsDatabase.DATE_RECEIVED + \" AS \" + MmsSmsColumns.NORMALIZED_DATE_RECEIVED,MmsDatabase.TABLE_NAME + \".\" + MmsDatabase.ID+ \" AS \"+ MmsSmsColumns.ID,\"'MMS::' || \" + MmsDatabase.TABLE_NAME + \".\"+ MmsDatabase.ID+ \" || '::' || \"+ MmsDatabase.DATE_SENT+ \" AS \"+ MmsSmsColumns.UNIQUE_ROW_ID,attachmentJsonJoin + \" AS \" + AttachmentDatabase.ATTACHMENT_JSON_ALIAS,SmsDatabase.BODY,MmsSmsColumns.READ,MmsSmsColumns.THREAD_ID,SmsDatabase.TYPE,SmsDatabase.RECIPIENT_ID,SmsDatabase.ADDRESS_DEVICE_ID,SmsDatabase.SUBJECT,MmsDatabase.MESSAGE_TYPE,MmsDatabase.MESSAGE_BOX,SmsDatabase.STATUS,MmsDatabase.PART_COUNT,MmsDatabase.CONTENT_LOCATION,MmsDatabase.TRANSACTION_ID,MmsDatabase.MESSAGE_SIZE,MmsDatabase.EXPIRY,MmsDatabase.STATUS,MmsDatabase.UNIDENTIFIED,MmsSmsColumns.DELIVERY_RECEIPT_COUNT,MmsSmsColumns.READ_RECEIPT_COUNT,MmsSmsColumns.MISMATCHED_IDENTITIES,MmsSmsColumns.SUBSCRIPTION_ID,MmsSmsColumns.EXPIRES_IN,MmsSmsColumns.EXPIRE_STARTED,MmsSmsColumns.NOTIFIED,MmsDatabase.NETWORK_FAILURE,TRANSPORT,MmsDatabase.QUOTE_ID,MmsDatabase.QUOTE_AUTHOR,MmsDatabase.QUOTE_BODY,MmsDatabase.QUOTE_MISSING,MmsDatabase.QUOTE_ATTACHMENT,MmsDatabase.QUOTE_MENTIONS,MmsDatabase.SHARED_CONTACTS,MmsDatabase.LINK_PREVIEWS,MmsDatabase.VIEW_ONCE,MmsDatabase.REACTIONS,MmsSmsColumns.REACTIONS_UNREAD,MmsSmsColumns.REACTIONS_LAST_SEEN,MmsSmsColumns.DATE_SERVER,MmsSmsColumns.REMOTE_DELETED,MmsDatabase.MENTIONS_SELF,MmsSmsColumns.NOTIFIED_TIMESTAMP,MmsSmsColumns.VIEWED_RECEIPT_COUNT,MmsSmsColumns.RECEIPT_TIMESTAMP};\n  String[] smsProjection={SmsDatabase.DATE_SENT + \" AS \" + MmsSmsColumns.NORMALIZED_DATE_SENT,SmsDatabase.DATE_RECEIVED + \" AS \" + MmsSmsColumns.NORMALIZED_DATE_RECEIVED,MmsSmsColumns.ID,\"'SMS::' || \" + MmsSmsColumns.ID + \" || '::' || \"+ SmsDatabase.DATE_SENT+ \" AS \"+ MmsSmsColumns.UNIQUE_ROW_ID,\"NULL AS \" + AttachmentDatabase.ATTACHMENT_JSON_ALIAS,SmsDatabase.BODY,MmsSmsColumns.READ,MmsSmsColumns.THREAD_ID,SmsDatabase.TYPE,SmsDatabase.RECIPIENT_ID,SmsDatabase.ADDRESS_DEVICE_ID,SmsDatabase.SUBJECT,MmsDatabase.MESSAGE_TYPE,MmsDatabase.MESSAGE_BOX,SmsDatabase.STATUS,MmsDatabase.PART_COUNT,MmsDatabase.CONTENT_LOCATION,MmsDatabase.TRANSACTION_ID,MmsDatabase.MESSAGE_SIZE,MmsDatabase.EXPIRY,MmsDatabase.STATUS,MmsDatabase.UNIDENTIFIED,MmsSmsColumns.DELIVERY_RECEIPT_COUNT,MmsSmsColumns.READ_RECEIPT_COUNT,MmsSmsColumns.MISMATCHED_IDENTITIES,MmsSmsColumns.SUBSCRIPTION_ID,MmsSmsColumns.EXPIRES_IN,MmsSmsColumns.EXPIRE_STARTED,MmsSmsColumns.NOTIFIED,MmsDatabase.NETWORK_FAILURE,TRANSPORT,MmsDatabase.QUOTE_ID,MmsDatabase.QUOTE_AUTHOR,MmsDatabase.QUOTE_BODY,MmsDatabase.QUOTE_MISSING,MmsDatabase.QUOTE_ATTACHMENT,MmsDatabase.QUOTE_MENTIONS,MmsDatabase.SHARED_CONTACTS,MmsDatabase.LINK_PREVIEWS,MmsDatabase.VIEW_ONCE,MmsDatabase.REACTIONS,MmsSmsColumns.REACTIONS_UNREAD,MmsSmsColumns.REACTIONS_LAST_SEEN,MmsSmsColumns.DATE_SERVER,MmsSmsColumns.REMOTE_DELETED,MmsDatabase.MENTIONS_SELF,MmsSmsColumns.NOTIFIED_TIMESTAMP,MmsSmsColumns.VIEWED_RECEIPT_COUNT,MmsSmsColumns.RECEIPT_TIMESTAMP};\n  SQLiteQueryBuilder mmsQueryBuilder=new SQLiteQueryBuilder();\n  SQLiteQueryBuilder smsQueryBuilder=new SQLiteQueryBuilder();\n  if (includeAttachments) {\n    mmsQueryBuilder.setDistinct(true);\n    smsQueryBuilder.setDistinct(true);\n  }\n  smsQueryBuilder.setTables(SmsDatabase.TABLE_NAME);\n  if (includeAttachments) {\n    mmsQueryBuilder.setTables(MmsDatabase.TABLE_NAME + \" LEFT OUTER JOIN \" + AttachmentDatabase.TABLE_NAME+ \" ON \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.MMS_ID+ \" = \"+ MmsDatabase.TABLE_NAME+ \".\"+ MmsDatabase.ID);\n  }\n else {\n    mmsQueryBuilder.setTables(MmsDatabase.TABLE_NAME);\n  }\n  Set<String> mmsColumnsPresent=new HashSet<>();\n  mmsColumnsPresent.add(MmsSmsColumns.ID);\n  mmsColumnsPresent.add(MmsSmsColumns.READ);\n  mmsColumnsPresent.add(MmsSmsColumns.THREAD_ID);\n  mmsColumnsPresent.add(MmsSmsColumns.BODY);\n  mmsColumnsPresent.add(MmsSmsColumns.RECIPIENT_ID);\n  mmsColumnsPresent.add(MmsSmsColumns.ADDRESS_DEVICE_ID);\n  mmsColumnsPresent.add(MmsSmsColumns.DELIVERY_RECEIPT_COUNT);\n  mmsColumnsPresent.add(MmsSmsColumns.READ_RECEIPT_COUNT);\n  mmsColumnsPresent.add(MmsSmsColumns.MISMATCHED_IDENTITIES);\n  mmsColumnsPresent.add(MmsSmsColumns.SUBSCRIPTION_ID);\n  mmsColumnsPresent.add(MmsSmsColumns.EXPIRES_IN);\n  mmsColumnsPresent.add(MmsSmsColumns.EXPIRE_STARTED);\n  mmsColumnsPresent.add(MmsDatabase.MESSAGE_TYPE);\n  mmsColumnsPresent.add(MmsDatabase.MESSAGE_BOX);\n  mmsColumnsPresent.add(MmsDatabase.DATE_SENT);\n  mmsColumnsPresent.add(MmsDatabase.DATE_RECEIVED);\n  mmsColumnsPresent.add(MmsDatabase.DATE_SERVER);\n  mmsColumnsPresent.add(MmsDatabase.PART_COUNT);\n  mmsColumnsPresent.add(MmsDatabase.CONTENT_LOCATION);\n  mmsColumnsPresent.add(MmsDatabase.TRANSACTION_ID);\n  mmsColumnsPresent.add(MmsDatabase.MESSAGE_SIZE);\n  mmsColumnsPresent.add(MmsDatabase.EXPIRY);\n  mmsColumnsPresent.add(MmsDatabase.NOTIFIED);\n  mmsColumnsPresent.add(MmsDatabase.STATUS);\n  mmsColumnsPresent.add(MmsDatabase.UNIDENTIFIED);\n  mmsColumnsPresent.add(MmsDatabase.NETWORK_FAILURE);\n  mmsColumnsPresent.add(MmsDatabase.QUOTE_ID);\n  mmsColumnsPresent.add(MmsDatabase.QUOTE_AUTHOR);\n  mmsColumnsPresent.add(MmsDatabase.QUOTE_BODY);\n  mmsColumnsPresent.add(MmsDatabase.QUOTE_MISSING);\n  mmsColumnsPresent.add(MmsDatabase.QUOTE_ATTACHMENT);\n  mmsColumnsPresent.add(MmsDatabase.QUOTE_MENTIONS);\n  mmsColumnsPresent.add(MmsDatabase.SHARED_CONTACTS);\n  mmsColumnsPresent.add(MmsDatabase.LINK_PREVIEWS);\n  mmsColumnsPresent.add(MmsDatabase.VIEW_ONCE);\n  mmsColumnsPresent.add(MmsDatabase.REACTIONS);\n  mmsColumnsPresent.add(MmsDatabase.REACTIONS_UNREAD);\n  mmsColumnsPresent.add(MmsDatabase.REACTIONS_LAST_SEEN);\n  mmsColumnsPresent.add(MmsDatabase.REMOTE_DELETED);\n  mmsColumnsPresent.add(MmsDatabase.MENTIONS_SELF);\n  mmsColumnsPresent.add(MmsSmsColumns.NOTIFIED_TIMESTAMP);\n  mmsColumnsPresent.add(MmsSmsColumns.VIEWED_RECEIPT_COUNT);\n  mmsColumnsPresent.add(MmsSmsColumns.RECEIPT_TIMESTAMP);\n  Set<String> smsColumnsPresent=new HashSet<>();\n  smsColumnsPresent.add(MmsSmsColumns.ID);\n  smsColumnsPresent.add(MmsSmsColumns.BODY);\n  smsColumnsPresent.add(MmsSmsColumns.RECIPIENT_ID);\n  smsColumnsPresent.add(MmsSmsColumns.ADDRESS_DEVICE_ID);\n  smsColumnsPresent.add(MmsSmsColumns.READ);\n  smsColumnsPresent.add(MmsSmsColumns.THREAD_ID);\n  smsColumnsPresent.add(MmsSmsColumns.DELIVERY_RECEIPT_COUNT);\n  smsColumnsPresent.add(MmsSmsColumns.READ_RECEIPT_COUNT);\n  smsColumnsPresent.add(MmsSmsColumns.MISMATCHED_IDENTITIES);\n  smsColumnsPresent.add(MmsSmsColumns.SUBSCRIPTION_ID);\n  smsColumnsPresent.add(MmsSmsColumns.EXPIRES_IN);\n  smsColumnsPresent.add(MmsSmsColumns.EXPIRE_STARTED);\n  smsColumnsPresent.add(MmsSmsColumns.NOTIFIED);\n  smsColumnsPresent.add(SmsDatabase.TYPE);\n  smsColumnsPresent.add(SmsDatabase.SUBJECT);\n  smsColumnsPresent.add(SmsDatabase.DATE_SENT);\n  smsColumnsPresent.add(SmsDatabase.DATE_RECEIVED);\n  smsColumnsPresent.add(SmsDatabase.DATE_SERVER);\n  smsColumnsPresent.add(SmsDatabase.STATUS);\n  smsColumnsPresent.add(SmsDatabase.UNIDENTIFIED);\n  smsColumnsPresent.add(SmsDatabase.REACTIONS);\n  smsColumnsPresent.add(SmsDatabase.REACTIONS_UNREAD);\n  smsColumnsPresent.add(SmsDatabase.REACTIONS_LAST_SEEN);\n  smsColumnsPresent.add(MmsDatabase.REMOTE_DELETED);\n  smsColumnsPresent.add(MmsSmsColumns.NOTIFIED_TIMESTAMP);\n  smsColumnsPresent.add(MmsSmsColumns.RECEIPT_TIMESTAMP);\n  String mmsGroupBy=includeAttachments ? MmsDatabase.TABLE_NAME + \".\" + MmsDatabase.ID : null;\n  String mmsSubQuery=mmsQueryBuilder.buildUnionSubQuery(TRANSPORT,mmsProjection,mmsColumnsPresent,4,MMS_TRANSPORT,selection,null,mmsGroupBy,null);\n  String smsSubQuery=smsQueryBuilder.buildUnionSubQuery(TRANSPORT,smsProjection,smsColumnsPresent,4,SMS_TRANSPORT,selection,null,null,null);\n  SQLiteQueryBuilder unionQueryBuilder=new SQLiteQueryBuilder();\n  String unionQuery=unionQueryBuilder.buildUnionQuery(new String[]{smsSubQuery,mmsSubQuery},order,limit);\n  SQLiteQueryBuilder outerQueryBuilder=new SQLiteQueryBuilder();\n  outerQueryBuilder.setTables(\"(\" + unionQuery + \")\");\n  return outerQueryBuilder.buildQuery(projection,null,null,null,null,null,null);\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 1433,
      "astHeight" : 8
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
      "nodePosition" : {
        "charLength" : 15949,
        "startLineNumber" : 617,
        "startColumnNumber" : 2,
        "endLineNumber" : 823,
        "endColumnNumber" : 3
      },
      "nodeContext" : "private static @NonNull String buildQuery(String[] projection,String selection,String order,String limit,boolean includeAttachments){\n  String attachmentJsonJoin;\n  if (includeAttachments) {\n    attachmentJsonJoin=\"json_group_array(json_object(\" + \"'\" + AttachmentDatabase.ROW_ID + \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.ROW_ID+ \", \"+ \"'\"+ AttachmentDatabase.UNIQUE_ID+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.UNIQUE_ID+ \", \"+ \"'\"+ AttachmentDatabase.MMS_ID+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.MMS_ID+ \",\"+ \"'\"+ AttachmentDatabase.SIZE+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.SIZE+ \", \"+ \"'\"+ AttachmentDatabase.FILE_NAME+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.FILE_NAME+ \", \"+ \"'\"+ AttachmentDatabase.DATA+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.DATA+ \", \"+ \"'\"+ AttachmentDatabase.CONTENT_TYPE+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.CONTENT_TYPE+ \", \"+ \"'\"+ AttachmentDatabase.CDN_NUMBER+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.CDN_NUMBER+ \", \"+ \"'\"+ AttachmentDatabase.CONTENT_LOCATION+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.CONTENT_LOCATION+ \", \"+ \"'\"+ AttachmentDatabase.FAST_PREFLIGHT_ID+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.FAST_PREFLIGHT_ID+ \", \"+ \"'\"+ AttachmentDatabase.VOICE_NOTE+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.VOICE_NOTE+ \", \"+ \"'\"+ AttachmentDatabase.BORDERLESS+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.BORDERLESS+ \", \"+ \"'\"+ AttachmentDatabase.VIDEO_GIF+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.VIDEO_GIF+ \", \"+ \"'\"+ AttachmentDatabase.WIDTH+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.WIDTH+ \", \"+ \"'\"+ AttachmentDatabase.HEIGHT+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.HEIGHT+ \", \"+ \"'\"+ AttachmentDatabase.QUOTE+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.QUOTE+ \", \"+ \"'\"+ AttachmentDatabase.CONTENT_DISPOSITION+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.CONTENT_DISPOSITION+ \", \"+ \"'\"+ AttachmentDatabase.NAME+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.NAME+ \", \"+ \"'\"+ AttachmentDatabase.TRANSFER_STATE+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.TRANSFER_STATE+ \", \"+ \"'\"+ AttachmentDatabase.CAPTION+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.CAPTION+ \", \"+ \"'\"+ AttachmentDatabase.STICKER_PACK_ID+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.STICKER_PACK_ID+ \", \"+ \"'\"+ AttachmentDatabase.STICKER_PACK_KEY+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.STICKER_PACK_KEY+ \", \"+ \"'\"+ AttachmentDatabase.STICKER_ID+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.STICKER_ID+ \", \"+ \"'\"+ AttachmentDatabase.STICKER_EMOJI+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.STICKER_EMOJI+ \", \"+ \"'\"+ AttachmentDatabase.VISUAL_HASH+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.VISUAL_HASH+ \", \"+ \"'\"+ AttachmentDatabase.TRANSFORM_PROPERTIES+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.TRANSFORM_PROPERTIES+ \", \"+ \"'\"+ AttachmentDatabase.DISPLAY_ORDER+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.DISPLAY_ORDER+ \", \"+ \"'\"+ AttachmentDatabase.UPLOAD_TIMESTAMP+ \"', \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.UPLOAD_TIMESTAMP+ \"))\";\n  }\n else {\n    attachmentJsonJoin=\"NULL\";\n  }\n  String[] mmsProjection={MmsDatabase.DATE_SENT + \" AS \" + MmsSmsColumns.NORMALIZED_DATE_SENT,MmsDatabase.DATE_RECEIVED + \" AS \" + MmsSmsColumns.NORMALIZED_DATE_RECEIVED,MmsDatabase.TABLE_NAME + \".\" + MmsDatabase.ID+ \" AS \"+ MmsSmsColumns.ID,\"'MMS::' || \" + MmsDatabase.TABLE_NAME + \".\"+ MmsDatabase.ID+ \" || '::' || \"+ MmsDatabase.DATE_SENT+ \" AS \"+ MmsSmsColumns.UNIQUE_ROW_ID,attachmentJsonJoin + \" AS \" + AttachmentDatabase.ATTACHMENT_JSON_ALIAS,SmsDatabase.BODY,MmsSmsColumns.READ,MmsSmsColumns.THREAD_ID,SmsDatabase.TYPE,SmsDatabase.RECIPIENT_ID,SmsDatabase.ADDRESS_DEVICE_ID,SmsDatabase.SUBJECT,MmsDatabase.MESSAGE_TYPE,MmsDatabase.MESSAGE_BOX,SmsDatabase.STATUS,MmsDatabase.PART_COUNT,MmsDatabase.CONTENT_LOCATION,MmsDatabase.TRANSACTION_ID,MmsDatabase.MESSAGE_SIZE,MmsDatabase.EXPIRY,MmsDatabase.STATUS,MmsDatabase.UNIDENTIFIED,MmsSmsColumns.DELIVERY_RECEIPT_COUNT,MmsSmsColumns.READ_RECEIPT_COUNT,MmsSmsColumns.MISMATCHED_IDENTITIES,MmsSmsColumns.SUBSCRIPTION_ID,MmsSmsColumns.EXPIRES_IN,MmsSmsColumns.EXPIRE_STARTED,MmsSmsColumns.NOTIFIED,MmsDatabase.NETWORK_FAILURE,TRANSPORT,MmsDatabase.QUOTE_ID,MmsDatabase.QUOTE_AUTHOR,MmsDatabase.QUOTE_BODY,MmsDatabase.QUOTE_MISSING,MmsDatabase.QUOTE_ATTACHMENT,MmsDatabase.QUOTE_MENTIONS,MmsDatabase.SHARED_CONTACTS,MmsDatabase.LINK_PREVIEWS,MmsDatabase.VIEW_ONCE,MmsDatabase.REACTIONS,MmsSmsColumns.REACTIONS_UNREAD,MmsSmsColumns.REACTIONS_LAST_SEEN,MmsSmsColumns.DATE_SERVER,MmsSmsColumns.REMOTE_DELETED,MmsDatabase.MENTIONS_SELF,MmsSmsColumns.NOTIFIED_TIMESTAMP,MmsSmsColumns.VIEWED_RECEIPT_COUNT,MmsSmsColumns.RECEIPT_TIMESTAMP};\n  String[] smsProjection={SmsDatabase.DATE_SENT + \" AS \" + MmsSmsColumns.NORMALIZED_DATE_SENT,SmsDatabase.DATE_RECEIVED + \" AS \" + MmsSmsColumns.NORMALIZED_DATE_RECEIVED,MmsSmsColumns.ID,\"'SMS::' || \" + MmsSmsColumns.ID + \" || '::' || \"+ SmsDatabase.DATE_SENT+ \" AS \"+ MmsSmsColumns.UNIQUE_ROW_ID,\"NULL AS \" + AttachmentDatabase.ATTACHMENT_JSON_ALIAS,SmsDatabase.BODY,MmsSmsColumns.READ,MmsSmsColumns.THREAD_ID,SmsDatabase.TYPE,SmsDatabase.RECIPIENT_ID,SmsDatabase.ADDRESS_DEVICE_ID,SmsDatabase.SUBJECT,MmsDatabase.MESSAGE_TYPE,MmsDatabase.MESSAGE_BOX,SmsDatabase.STATUS,MmsDatabase.PART_COUNT,MmsDatabase.CONTENT_LOCATION,MmsDatabase.TRANSACTION_ID,MmsDatabase.MESSAGE_SIZE,MmsDatabase.EXPIRY,MmsDatabase.STATUS,MmsDatabase.UNIDENTIFIED,MmsSmsColumns.DELIVERY_RECEIPT_COUNT,MmsSmsColumns.READ_RECEIPT_COUNT,MmsSmsColumns.MISMATCHED_IDENTITIES,MmsSmsColumns.SUBSCRIPTION_ID,MmsSmsColumns.EXPIRES_IN,MmsSmsColumns.EXPIRE_STARTED,MmsSmsColumns.NOTIFIED,MmsDatabase.NETWORK_FAILURE,TRANSPORT,MmsDatabase.QUOTE_ID,MmsDatabase.QUOTE_AUTHOR,MmsDatabase.QUOTE_BODY,MmsDatabase.QUOTE_MISSING,MmsDatabase.QUOTE_ATTACHMENT,MmsDatabase.QUOTE_MENTIONS,MmsDatabase.SHARED_CONTACTS,MmsDatabase.LINK_PREVIEWS,MmsDatabase.VIEW_ONCE,MmsDatabase.REACTIONS,MmsSmsColumns.REACTIONS_UNREAD,MmsSmsColumns.REACTIONS_LAST_SEEN,MmsSmsColumns.DATE_SERVER,MmsSmsColumns.REMOTE_DELETED,MmsDatabase.MENTIONS_SELF,MmsSmsColumns.NOTIFIED_TIMESTAMP,MmsSmsColumns.VIEWED_RECEIPT_COUNT,MmsSmsColumns.RECEIPT_TIMESTAMP};\n  SQLiteQueryBuilder mmsQueryBuilder=new SQLiteQueryBuilder();\n  SQLiteQueryBuilder smsQueryBuilder=new SQLiteQueryBuilder();\n  if (includeAttachments) {\n    mmsQueryBuilder.setDistinct(true);\n    smsQueryBuilder.setDistinct(true);\n  }\n  smsQueryBuilder.setTables(SmsDatabase.TABLE_NAME);\n  if (includeAttachments) {\n    mmsQueryBuilder.setTables(MmsDatabase.TABLE_NAME + \" LEFT OUTER JOIN \" + AttachmentDatabase.TABLE_NAME+ \" ON \"+ AttachmentDatabase.TABLE_NAME+ \".\"+ AttachmentDatabase.MMS_ID+ \" = \"+ MmsDatabase.TABLE_NAME+ \".\"+ MmsDatabase.ID);\n  }\n else {\n    mmsQueryBuilder.setTables(MmsDatabase.TABLE_NAME);\n  }\n  Set<String> mmsColumnsPresent=new HashSet<>();\n  mmsColumnsPresent.add(MmsSmsColumns.ID);\n  mmsColumnsPresent.add(MmsSmsColumns.READ);\n  mmsColumnsPresent.add(MmsSmsColumns.THREAD_ID);\n  mmsColumnsPresent.add(MmsSmsColumns.BODY);\n  mmsColumnsPresent.add(MmsSmsColumns.RECIPIENT_ID);\n  mmsColumnsPresent.add(MmsSmsColumns.ADDRESS_DEVICE_ID);\n  mmsColumnsPresent.add(MmsSmsColumns.DELIVERY_RECEIPT_COUNT);\n  mmsColumnsPresent.add(MmsSmsColumns.READ_RECEIPT_COUNT);\n  mmsColumnsPresent.add(MmsSmsColumns.MISMATCHED_IDENTITIES);\n  mmsColumnsPresent.add(MmsSmsColumns.SUBSCRIPTION_ID);\n  mmsColumnsPresent.add(MmsSmsColumns.EXPIRES_IN);\n  mmsColumnsPresent.add(MmsSmsColumns.EXPIRE_STARTED);\n  mmsColumnsPresent.add(MmsDatabase.MESSAGE_TYPE);\n  mmsColumnsPresent.add(MmsDatabase.MESSAGE_BOX);\n  mmsColumnsPresent.add(MmsDatabase.DATE_SENT);\n  mmsColumnsPresent.add(MmsDatabase.DATE_RECEIVED);\n  mmsColumnsPresent.add(MmsDatabase.DATE_SERVER);\n  mmsColumnsPresent.add(MmsDatabase.PART_COUNT);\n  mmsColumnsPresent.add(MmsDatabase.CONTENT_LOCATION);\n  mmsColumnsPresent.add(MmsDatabase.TRANSACTION_ID);\n  mmsColumnsPresent.add(MmsDatabase.MESSAGE_SIZE);\n  mmsColumnsPresent.add(MmsDatabase.EXPIRY);\n  mmsColumnsPresent.add(MmsDatabase.NOTIFIED);\n  mmsColumnsPresent.add(MmsDatabase.STATUS);\n  mmsColumnsPresent.add(MmsDatabase.UNIDENTIFIED);\n  mmsColumnsPresent.add(MmsDatabase.NETWORK_FAILURE);\n  mmsColumnsPresent.add(MmsDatabase.QUOTE_ID);\n  mmsColumnsPresent.add(MmsDatabase.QUOTE_AUTHOR);\n  mmsColumnsPresent.add(MmsDatabase.QUOTE_BODY);\n  mmsColumnsPresent.add(MmsDatabase.QUOTE_MISSING);\n  mmsColumnsPresent.add(MmsDatabase.QUOTE_ATTACHMENT);\n  mmsColumnsPresent.add(MmsDatabase.QUOTE_MENTIONS);\n  mmsColumnsPresent.add(MmsDatabase.SHARED_CONTACTS);\n  mmsColumnsPresent.add(MmsDatabase.LINK_PREVIEWS);\n  mmsColumnsPresent.add(MmsDatabase.VIEW_ONCE);\n  mmsColumnsPresent.add(MmsDatabase.REACTIONS);\n  mmsColumnsPresent.add(MmsDatabase.REACTIONS_UNREAD);\n  mmsColumnsPresent.add(MmsDatabase.REACTIONS_LAST_SEEN);\n  mmsColumnsPresent.add(MmsDatabase.REMOTE_DELETED);\n  mmsColumnsPresent.add(MmsDatabase.MENTIONS_SELF);\n  mmsColumnsPresent.add(MmsSmsColumns.NOTIFIED_TIMESTAMP);\n  mmsColumnsPresent.add(MmsSmsColumns.VIEWED_RECEIPT_COUNT);\n  mmsColumnsPresent.add(MmsSmsColumns.RECEIPT_TIMESTAMP);\n  Set<String> smsColumnsPresent=new HashSet<>();\n  smsColumnsPresent.add(MmsSmsColumns.ID);\n  smsColumnsPresent.add(MmsSmsColumns.BODY);\n  smsColumnsPresent.add(MmsSmsColumns.RECIPIENT_ID);\n  smsColumnsPresent.add(MmsSmsColumns.ADDRESS_DEVICE_ID);\n  smsColumnsPresent.add(MmsSmsColumns.READ);\n  smsColumnsPresent.add(MmsSmsColumns.THREAD_ID);\n  smsColumnsPresent.add(MmsSmsColumns.DELIVERY_RECEIPT_COUNT);\n  smsColumnsPresent.add(MmsSmsColumns.READ_RECEIPT_COUNT);\n  smsColumnsPresent.add(MmsSmsColumns.MISMATCHED_IDENTITIES);\n  smsColumnsPresent.add(MmsSmsColumns.SUBSCRIPTION_ID);\n  smsColumnsPresent.add(MmsSmsColumns.EXPIRES_IN);\n  smsColumnsPresent.add(MmsSmsColumns.EXPIRE_STARTED);\n  smsColumnsPresent.add(MmsSmsColumns.NOTIFIED);\n  smsColumnsPresent.add(SmsDatabase.TYPE);\n  smsColumnsPresent.add(SmsDatabase.SUBJECT);\n  smsColumnsPresent.add(SmsDatabase.DATE_SENT);\n  smsColumnsPresent.add(SmsDatabase.DATE_RECEIVED);\n  smsColumnsPresent.add(SmsDatabase.DATE_SERVER);\n  smsColumnsPresent.add(SmsDatabase.STATUS);\n  smsColumnsPresent.add(SmsDatabase.UNIDENTIFIED);\n  smsColumnsPresent.add(SmsDatabase.REACTIONS);\n  smsColumnsPresent.add(SmsDatabase.REACTIONS_UNREAD);\n  smsColumnsPresent.add(SmsDatabase.REACTIONS_LAST_SEEN);\n  smsColumnsPresent.add(MmsDatabase.REMOTE_DELETED);\n  smsColumnsPresent.add(MmsSmsColumns.NOTIFIED_TIMESTAMP);\n  smsColumnsPresent.add(MmsSmsColumns.RECEIPT_TIMESTAMP);\n  String mmsGroupBy=includeAttachments ? MmsDatabase.TABLE_NAME + \".\" + MmsDatabase.ID : null;\n  String mmsSubQuery=mmsQueryBuilder.buildUnionSubQuery(TRANSPORT,mmsProjection,mmsColumnsPresent,4,MMS_TRANSPORT,selection,null,mmsGroupBy,null);\n  String smsSubQuery=smsQueryBuilder.buildUnionSubQuery(TRANSPORT,smsProjection,smsColumnsPresent,4,SMS_TRANSPORT,selection,null,null,null);\n  SQLiteQueryBuilder unionQueryBuilder=new SQLiteQueryBuilder();\n  String unionQuery=unionQueryBuilder.buildUnionQuery(new String[]{smsSubQuery,mmsSubQuery},order,limit);\n  SQLiteQueryBuilder outerQueryBuilder=new SQLiteQueryBuilder();\n  outerQueryBuilder.setTables(\"(\" + unionQuery + \")\");\n  return outerQueryBuilder.buildQuery(projection,null,null,null,null,null,null);\n}\n",
      "nodeType" : "MethodDeclaration",
      "astNodeNumber" : 1462,
      "astHeight" : 9
    } ],
    "currentLineData" : {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 130,
        "startLineNumber" : 817,
        "startColumnNumber" : 4,
        "endLineNumber" : 817,
        "endColumnNumber" : 134
      },
      "nodeContext" : "String unionQuery=unionQueryBuilder.buildUnionQuery(new String[]{smsSubQuery,mmsSubQuery},order,limit);\n",
      "nodeType" : "VariableDeclarationStatement",
      "astNodeNumber" : 18,
      "astHeight" : 7
    },
    "tokenLength" : 3,
    "type" : "java.lang.String[]"
  } ],
  "positionList" : [ {
    "charLength" : 41,
    "startLineNumber" : 817,
    "startColumnNumber" : 77,
    "endLineNumber" : 817,
    "endColumnNumber" : 118
  } ],
  "layoutRelationDataList" : [ ]
}