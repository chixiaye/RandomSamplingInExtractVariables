{
  "id" : 181,
  "expression" : "\"Can't convert string concatenation: {} insn: {}\"",
  "projectName" : "skylot@jadx",
  "commitID" : "72b2663949555b03aeb864775d84f163b91bcea7",
  "filePath" : "jadx-core/src/main/java/jadx/core/dex/visitors/SimplifyVisitor.java",
  "occurrences" : 1,
  "isArithmeticExpression" : 0,
  "isGetTypeMethod" : 0,
  "expressionList" : [ {
    "nodeContext" : "\"Can't convert string concatenation: {} insn: {}\"",
    "nodeType" : "StringLiteral",
    "nodePosition" : {
      "charLength" : 49,
      "startLineNumber" : 222,
      "startColumnNumber" : 13,
      "endLineNumber" : 222,
      "endColumnNumber" : 62
    },
    "astNodeNumber" : 1,
    "astHeight" : 1,
    "parentDataList" : [ {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.ExpressionStatement,expression]",
      "nodePosition" : {
        "charLength" : 73,
        "startLineNumber" : 222,
        "startColumnNumber" : 4,
        "endLineNumber" : 222,
        "endColumnNumber" : 77
      },
      "nodeContext" : "LOG.warn(\"Can't convert string concatenation: {} insn: {}\",mth,insn,e)",
      "nodeType" : "MethodInvocation",
      "astNodeNumber" : 7,
      "astHeight" : 2
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 74,
        "startLineNumber" : 222,
        "startColumnNumber" : 4,
        "endLineNumber" : 222,
        "endColumnNumber" : 78
      },
      "nodeContext" : "LOG.warn(\"Can't convert string concatenation: {} insn: {}\",mth,insn,e);\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 8,
      "astHeight" : 3
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.CatchClause,body]",
      "nodePosition" : {
        "charLength" : 85,
        "startLineNumber" : 221,
        "startColumnNumber" : 25,
        "endLineNumber" : 223,
        "endColumnNumber" : 4
      },
      "nodeContext" : "{\n  LOG.warn(\"Can't convert string concatenation: {} insn: {}\",mth,insn,e);\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 9,
      "astHeight" : 4
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TryStatement,catchClauses]",
      "nodePosition" : {
        "charLength" : 105,
        "startLineNumber" : 221,
        "startColumnNumber" : 5,
        "endLineNumber" : 223,
        "endColumnNumber" : 4
      },
      "nodeContext" : "catch (Exception e) {\n  LOG.warn(\"Can't convert string concatenation: {} insn: {}\",mth,insn,e);\n}\n",
      "nodeType" : "CatchClause",
      "astNodeNumber" : 14,
      "astHeight" : 5
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 2939,
        "startLineNumber" : 162,
        "startColumnNumber" : 3,
        "endLineNumber" : 223,
        "endColumnNumber" : 4
      },
      "nodeContext" : "try {\n  List<InsnNode> chain=flattenInsnChain(insn);\n  int constrIndex=-1;\n  if (chain.size() > 1 && chain.get(0).getType() == InsnType.CONSTRUCTOR) {\n    constrIndex=0;\n  }\n else   if (chain.size() > 2 && chain.get(1).getType() == InsnType.CONSTRUCTOR) {\n    constrIndex=1;\n  }\n else   if (chain.size() > 3 && chain.get(2).getType() == InsnType.CONSTRUCTOR) {\n    constrIndex=2;\n  }\n  if (constrIndex != -1) {\n    ConstructorInsn constr=(ConstructorInsn)chain.get(constrIndex);\n    if (constr.getClassType().getFullName().equals(Consts.CLASS_STRING_BUILDER)) {\n      int len=chain.size(), argInd=1;\n      InsnNode concatInsn=new InsnNode(InsnType.STR_CONCAT,len - 1);\n      InsnNode argInsn;\n      if (constrIndex > 0) {\n        InsnWrapArg iwa;\n        if (constrIndex == 2 && (argInsn=chain.get(1)).getType() == InsnType.INVOKE && ((InvokeNode)argInsn).getCallMth().getName().compareTo(\"valueOf\") == 0) {\n          iwa=(InsnWrapArg)argInsn.getArg(0);\n          argInd=3;\n        }\n else {\n          InsnNode firstNode=chain.get(0);\n          if (firstNode instanceof ConstStringNode) {\n            ConstStringNode csn=(ConstStringNode)firstNode;\n            iwa=new InsnWrapArg(csn);\n            argInd=2;\n          }\n else {\n            return null;\n          }\n        }\n        concatInsn.addArg(iwa);\n      }\n      for (; argInd < len; argInd++) {\n        InsnNode node=chain.get(argInd);\n        MethodInfo method=((CallMthInterface)node).getCallMth();\n        if (!(node.getArgsCount() < 2 && method.isConstructor() || method.getName().equals(\"append\"))) {\n          return null;\n        }\n        concatInsn.addArg(node.getArg(1));\n      }\n      concatInsn.setResult(insn.getResult());\n      return concatInsn;\n    }\n  }\n}\n catch (Exception e) {\n  LOG.warn(\"Can't convert string concatenation: {} insn: {}\",mth,insn,e);\n}\n",
      "nodeType" : "TryStatement",
      "astNodeNumber" : 327,
      "astHeight" : 18
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.IfStatement,thenStatement]",
      "nodePosition" : {
        "charLength" : 2948,
        "startLineNumber" : 161,
        "startColumnNumber" : 36,
        "endLineNumber" : 224,
        "endColumnNumber" : 3
      },
      "nodeContext" : "{\n  try {\n    List<InsnNode> chain=flattenInsnChain(insn);\n    int constrIndex=-1;\n    if (chain.size() > 1 && chain.get(0).getType() == InsnType.CONSTRUCTOR) {\n      constrIndex=0;\n    }\n else     if (chain.size() > 2 && chain.get(1).getType() == InsnType.CONSTRUCTOR) {\n      constrIndex=1;\n    }\n else     if (chain.size() > 3 && chain.get(2).getType() == InsnType.CONSTRUCTOR) {\n      constrIndex=2;\n    }\n    if (constrIndex != -1) {\n      ConstructorInsn constr=(ConstructorInsn)chain.get(constrIndex);\n      if (constr.getClassType().getFullName().equals(Consts.CLASS_STRING_BUILDER)) {\n        int len=chain.size(), argInd=1;\n        InsnNode concatInsn=new InsnNode(InsnType.STR_CONCAT,len - 1);\n        InsnNode argInsn;\n        if (constrIndex > 0) {\n          InsnWrapArg iwa;\n          if (constrIndex == 2 && (argInsn=chain.get(1)).getType() == InsnType.INVOKE && ((InvokeNode)argInsn).getCallMth().getName().compareTo(\"valueOf\") == 0) {\n            iwa=(InsnWrapArg)argInsn.getArg(0);\n            argInd=3;\n          }\n else {\n            InsnNode firstNode=chain.get(0);\n            if (firstNode instanceof ConstStringNode) {\n              ConstStringNode csn=(ConstStringNode)firstNode;\n              iwa=new InsnWrapArg(csn);\n              argInd=2;\n            }\n else {\n              return null;\n            }\n          }\n          concatInsn.addArg(iwa);\n        }\n        for (; argInd < len; argInd++) {\n          InsnNode node=chain.get(argInd);\n          MethodInfo method=((CallMthInterface)node).getCallMth();\n          if (!(node.getArgsCount() < 2 && method.isConstructor() || method.getName().equals(\"append\"))) {\n            return null;\n          }\n          concatInsn.addArg(node.getArg(1));\n        }\n        concatInsn.setResult(insn.getResult());\n        return concatInsn;\n      }\n    }\n  }\n catch (  Exception e) {\n    LOG.warn(\"Can't convert string concatenation: {} insn: {}\",mth,insn,e);\n  }\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 328,
      "astHeight" : 19
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 3127,
        "startLineNumber" : 159,
        "startColumnNumber" : 2,
        "endLineNumber" : 224,
        "endColumnNumber" : 3
      },
      "nodeContext" : "if (callMth.getDeclClass().getFullName().equals(Consts.CLASS_STRING_BUILDER) && callMth.getShortId().equals(Consts.MTH_TOSTRING_SIGNATURE) && insn.getArg(0).isInsnWrap()) {\n  try {\n    List<InsnNode> chain=flattenInsnChain(insn);\n    int constrIndex=-1;\n    if (chain.size() > 1 && chain.get(0).getType() == InsnType.CONSTRUCTOR) {\n      constrIndex=0;\n    }\n else     if (chain.size() > 2 && chain.get(1).getType() == InsnType.CONSTRUCTOR) {\n      constrIndex=1;\n    }\n else     if (chain.size() > 3 && chain.get(2).getType() == InsnType.CONSTRUCTOR) {\n      constrIndex=2;\n    }\n    if (constrIndex != -1) {\n      ConstructorInsn constr=(ConstructorInsn)chain.get(constrIndex);\n      if (constr.getClassType().getFullName().equals(Consts.CLASS_STRING_BUILDER)) {\n        int len=chain.size(), argInd=1;\n        InsnNode concatInsn=new InsnNode(InsnType.STR_CONCAT,len - 1);\n        InsnNode argInsn;\n        if (constrIndex > 0) {\n          InsnWrapArg iwa;\n          if (constrIndex == 2 && (argInsn=chain.get(1)).getType() == InsnType.INVOKE && ((InvokeNode)argInsn).getCallMth().getName().compareTo(\"valueOf\") == 0) {\n            iwa=(InsnWrapArg)argInsn.getArg(0);\n            argInd=3;\n          }\n else {\n            InsnNode firstNode=chain.get(0);\n            if (firstNode instanceof ConstStringNode) {\n              ConstStringNode csn=(ConstStringNode)firstNode;\n              iwa=new InsnWrapArg(csn);\n              argInd=2;\n            }\n else {\n              return null;\n            }\n          }\n          concatInsn.addArg(iwa);\n        }\n        for (; argInd < len; argInd++) {\n          InsnNode node=chain.get(argInd);\n          MethodInfo method=((CallMthInterface)node).getCallMth();\n          if (!(node.getArgsCount() < 2 && method.isConstructor() || method.getName().equals(\"append\"))) {\n            return null;\n          }\n          concatInsn.addArg(node.getArg(1));\n        }\n        concatInsn.setResult(insn.getResult());\n        return concatInsn;\n      }\n    }\n  }\n catch (  Exception e) {\n    LOG.warn(\"Can't convert string concatenation: {} insn: {}\",mth,insn,e);\n  }\n}\n",
      "nodeType" : "IfStatement",
      "astNodeNumber" : 354,
      "astHeight" : 20
    }, {
      "locationInParent" : "ChildProperty[org.eclipse.jdt.core.dom.MethodDeclaration,body]",
      "nodePosition" : {
        "charLength" : 3338,
        "startLineNumber" : 154,
        "startColumnNumber" : 70,
        "endLineNumber" : 226,
        "endColumnNumber" : 2
      },
      "nodeContext" : "{\n  MethodInfo callMth=((InvokeNode)insn).getCallMth();\n  if (callMth.getDeclClass().getFullName().equals(Consts.CLASS_STRING_BUILDER) && callMth.getShortId().equals(Consts.MTH_TOSTRING_SIGNATURE) && insn.getArg(0).isInsnWrap()) {\n    try {\n      List<InsnNode> chain=flattenInsnChain(insn);\n      int constrIndex=-1;\n      if (chain.size() > 1 && chain.get(0).getType() == InsnType.CONSTRUCTOR) {\n        constrIndex=0;\n      }\n else       if (chain.size() > 2 && chain.get(1).getType() == InsnType.CONSTRUCTOR) {\n        constrIndex=1;\n      }\n else       if (chain.size() > 3 && chain.get(2).getType() == InsnType.CONSTRUCTOR) {\n        constrIndex=2;\n      }\n      if (constrIndex != -1) {\n        ConstructorInsn constr=(ConstructorInsn)chain.get(constrIndex);\n        if (constr.getClassType().getFullName().equals(Consts.CLASS_STRING_BUILDER)) {\n          int len=chain.size(), argInd=1;\n          InsnNode concatInsn=new InsnNode(InsnType.STR_CONCAT,len - 1);\n          InsnNode argInsn;\n          if (constrIndex > 0) {\n            InsnWrapArg iwa;\n            if (constrIndex == 2 && (argInsn=chain.get(1)).getType() == InsnType.INVOKE && ((InvokeNode)argInsn).getCallMth().getName().compareTo(\"valueOf\") == 0) {\n              iwa=(InsnWrapArg)argInsn.getArg(0);\n              argInd=3;\n            }\n else {\n              InsnNode firstNode=chain.get(0);\n              if (firstNode instanceof ConstStringNode) {\n                ConstStringNode csn=(ConstStringNode)firstNode;\n                iwa=new InsnWrapArg(csn);\n                argInd=2;\n              }\n else {\n                return null;\n              }\n            }\n            concatInsn.addArg(iwa);\n          }\n          for (; argInd < len; argInd++) {\n            InsnNode node=chain.get(argInd);\n            MethodInfo method=((CallMthInterface)node).getCallMth();\n            if (!(node.getArgsCount() < 2 && method.isConstructor() || method.getName().equals(\"append\"))) {\n              return null;\n            }\n            concatInsn.addArg(node.getArg(1));\n          }\n          concatInsn.setResult(insn.getResult());\n          return concatInsn;\n        }\n      }\n    }\n catch (    Exception e) {\n      LOG.warn(\"Can't convert string concatenation: {} insn: {}\",mth,insn,e);\n    }\n  }\n  return null;\n}\n",
      "nodeType" : "Block",
      "astNodeNumber" : 369,
      "astHeight" : 21
    }, {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.TypeDeclaration,bodyDeclarations]",
      "nodePosition" : {
        "charLength" : 3711,
        "startLineNumber" : 145,
        "startColumnNumber" : 1,
        "endLineNumber" : 226,
        "endColumnNumber" : 2
      },
      "nodeContext" : "/** \n * Simplify chains of calls to StringBuilder#append() plus constructor of StringBuilder. Those chains are usually automatically generated by the Java compiler when you create String concatenations like <code>\"text \" + 1 + \" text\"</code>.\n * @param mth\n * @param insn\n * @return\n */\nprivate static InsnNode convertInvoke(MethodNode mth,InsnNode insn){\n  MethodInfo callMth=((InvokeNode)insn).getCallMth();\n  if (callMth.getDeclClass().getFullName().equals(Consts.CLASS_STRING_BUILDER) && callMth.getShortId().equals(Consts.MTH_TOSTRING_SIGNATURE) && insn.getArg(0).isInsnWrap()) {\n    try {\n      List<InsnNode> chain=flattenInsnChain(insn);\n      int constrIndex=-1;\n      if (chain.size() > 1 && chain.get(0).getType() == InsnType.CONSTRUCTOR) {\n        constrIndex=0;\n      }\n else       if (chain.size() > 2 && chain.get(1).getType() == InsnType.CONSTRUCTOR) {\n        constrIndex=1;\n      }\n else       if (chain.size() > 3 && chain.get(2).getType() == InsnType.CONSTRUCTOR) {\n        constrIndex=2;\n      }\n      if (constrIndex != -1) {\n        ConstructorInsn constr=(ConstructorInsn)chain.get(constrIndex);\n        if (constr.getClassType().getFullName().equals(Consts.CLASS_STRING_BUILDER)) {\n          int len=chain.size(), argInd=1;\n          InsnNode concatInsn=new InsnNode(InsnType.STR_CONCAT,len - 1);\n          InsnNode argInsn;\n          if (constrIndex > 0) {\n            InsnWrapArg iwa;\n            if (constrIndex == 2 && (argInsn=chain.get(1)).getType() == InsnType.INVOKE && ((InvokeNode)argInsn).getCallMth().getName().compareTo(\"valueOf\") == 0) {\n              iwa=(InsnWrapArg)argInsn.getArg(0);\n              argInd=3;\n            }\n else {\n              InsnNode firstNode=chain.get(0);\n              if (firstNode instanceof ConstStringNode) {\n                ConstStringNode csn=(ConstStringNode)firstNode;\n                iwa=new InsnWrapArg(csn);\n                argInd=2;\n              }\n else {\n                return null;\n              }\n            }\n            concatInsn.addArg(iwa);\n          }\n          for (; argInd < len; argInd++) {\n            InsnNode node=chain.get(argInd);\n            MethodInfo method=((CallMthInterface)node).getCallMth();\n            if (!(node.getArgsCount() < 2 && method.isConstructor() || method.getName().equals(\"append\"))) {\n              return null;\n            }\n            concatInsn.addArg(node.getArg(1));\n          }\n          concatInsn.setResult(insn.getResult());\n          return concatInsn;\n        }\n      }\n    }\n catch (    Exception e) {\n      LOG.warn(\"Can't convert string concatenation: {} insn: {}\",mth,insn,e);\n    }\n  }\n  return null;\n}\n",
      "nodeType" : "MethodDeclaration",
      "astNodeNumber" : 384,
      "astHeight" : 22
    } ],
    "currentLineData" : {
      "locationInParent" : "ChildListProperty[org.eclipse.jdt.core.dom.Block,statements]",
      "nodePosition" : {
        "charLength" : 74,
        "startLineNumber" : 222,
        "startColumnNumber" : 4,
        "endLineNumber" : 222,
        "endColumnNumber" : 78
      },
      "nodeContext" : "LOG.warn(\"Can't convert string concatenation: {} insn: {}\",mth,insn,e);\n",
      "nodeType" : "ExpressionStatement",
      "astNodeNumber" : 8,
      "astHeight" : 3
    },
    "tokenLength" : 6,
    "type" : "java.lang.String"
  } ],
  "positionList" : [ {
    "charLength" : 49,
    "startLineNumber" : 222,
    "startColumnNumber" : 13,
    "endLineNumber" : 222,
    "endColumnNumber" : 62
  } ],
  "layoutRelationDataList" : [ ]
}